2025-09-28 10:03:58.859 +03:00 [INF] Starting database seeding.
2025-09-28 10:04:00.771 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:04:06.359 +03:00 [INF] Executed DbCommand (231ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:04:06.545 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:04:06.569 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:04:06.635 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 10:04:06.780 +03:00 [INF] Database seeding finished successfully.
2025-09-28 10:04:08.569 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 10:04:08.574 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 10:04:08.988 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 10:04:08.995 +03:00 [INF] Hosting environment: Development
2025-09-28 10:04:09.006 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 10:04:11.570 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 10:04:11.672 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/index.html - null null
2025-09-28 10:04:11.793 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 241.2614ms
2025-09-28 10:04:11.827 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 10:04:13.049 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/index.html - 200 null text/html;charset=utf-8 1378.3253ms
2025-09-28 10:04:13.098 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - null null
2025-09-28 10:04:13.110 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_vs/browserLink - null null
2025-09-28 10:04:13.124 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - 200 16539 application/javascript; charset=utf-8 25.6837ms
2025-09-28 10:04:13.894 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_vs/browserLink - 200 null text/javascript; charset=UTF-8 786.0075ms
2025-09-28 10:04:14.447 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - null null
2025-09-28 10:04:15.050 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 603.5963ms
2025-09-28 10:04:15.289 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:04:15 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 10:04:15.320 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:04:15 AM'.
2025-09-28 10:04:15.347 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 10:04:15.366 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 10:04:15.369 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 401 0 null 3541.6407ms
2025-09-28 10:04:51.908 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 10:04:51.921 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 14.108ms
2025-09-28 10:04:51.929 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 10:04:51.964 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:04:51 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 10:04:52.000 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:04:51 AM'.
2025-09-28 10:04:52.007 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 10:04:52.014 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 10:04:52.019 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 401 0 null 89.8909ms
2025-09-28 10:14:30.831 +03:00 [INF] Starting database seeding.
2025-09-28 10:14:31.385 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:14:34.521 +03:00 [INF] Executed DbCommand (101ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:14:34.703 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:14:34.716 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:14:34.747 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 10:14:34.808 +03:00 [INF] Database seeding finished successfully.
2025-09-28 10:14:35.656 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 10:14:35.658 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 10:14:35.856 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 10:14:35.859 +03:00 [INF] Hosting environment: Development
2025-09-28 10:14:35.861 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 10:14:36.292 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/index.html - null null
2025-09-28 10:14:36.908 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/index.html - 200 null text/html;charset=utf-8 630.8627ms
2025-09-28 10:14:36.936 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_vs/browserLink - null null
2025-09-28 10:14:36.931 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - null null
2025-09-28 10:14:37.429 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - 200 16539 application/javascript; charset=utf-8 434.0901ms
2025-09-28 10:14:37.503 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_vs/browserLink - 200 null text/javascript; charset=UTF-8 566.8183ms
2025-09-28 10:14:37.672 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - null null
2025-09-28 10:14:38.492 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 820.137ms
2025-09-28 10:14:49.260 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 10:14:49.384 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 124.7899ms
2025-09-28 10:14:49.423 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 10:14:49.750 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:14:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 10:14:49.853 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:14:49 AM'.
2025-09-28 10:14:49.905 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 10:14:49.950 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 10:14:49.961 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 401 0 null 537.5129ms
2025-09-28 10:22:49.721 +03:00 [INF] Starting database seeding.
2025-09-28 10:22:50.321 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:22:52.802 +03:00 [INF] Executed DbCommand (63ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:22:52.910 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:22:52.918 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:22:52.938 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 10:22:52.989 +03:00 [INF] Database seeding finished successfully.
2025-09-28 10:22:54.056 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 10:22:54.098 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 10:22:54.300 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 10:22:54.303 +03:00 [INF] Hosting environment: Development
2025-09-28 10:22:54.305 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 10:22:54.937 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/index.html - null null
2025-09-28 10:22:55.378 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/index.html - 200 null text/html;charset=utf-8 455.0229ms
2025-09-28 10:22:55.400 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - null null
2025-09-28 10:22:55.401 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_vs/browserLink - null null
2025-09-28 10:22:55.419 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - 200 16539 application/javascript; charset=utf-8 19.6509ms
2025-09-28 10:22:55.501 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_vs/browserLink - 200 null text/javascript; charset=UTF-8 101.8378ms
2025-09-28 10:22:55.641 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - null null
2025-09-28 10:22:56.339 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 698.025ms
2025-09-28 10:23:00.220 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 10:23:00.262 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 43.0245ms
2025-09-28 10:23:00.312 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 10:23:00.602 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:23:00 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 10:23:00.648 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:23:00 AM'.
2025-09-28 10:23:00.666 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 10:23:00.690 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 10:23:00.698 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 401 0 null 386.3826ms
2025-09-28 10:23:21.440 +03:00 [INF] Starting database seeding.
2025-09-28 10:23:21.825 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:23:25.035 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:23:25.264 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:23:25.274 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:23:25.314 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 10:23:25.458 +03:00 [INF] Database seeding finished successfully.
2025-09-28 10:23:26.436 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 10:23:26.438 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 10:23:26.691 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 10:23:26.769 +03:00 [INF] Hosting environment: Development
2025-09-28 10:23:26.772 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 10:23:27.250 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/index.html - null null
2025-09-28 10:23:27.629 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/index.html - 200 null text/html;charset=utf-8 389.8769ms
2025-09-28 10:23:27.663 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - null null
2025-09-28 10:23:27.663 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_vs/browserLink - null null
2025-09-28 10:23:27.696 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - 200 16539 application/javascript; charset=utf-8 31.9206ms
2025-09-28 10:23:27.750 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_vs/browserLink - 200 null text/javascript; charset=UTF-8 87.1812ms
2025-09-28 10:23:27.850 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - null null
2025-09-28 10:23:28.256 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 406.7637ms
2025-09-28 10:23:31.146 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 10:23:31.214 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 68.6453ms
2025-09-28 10:23:31.256 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 10:23:31.710 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:23:31 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 10:23:31.795 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:23:31 AM'.
2025-09-28 10:23:31.831 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 10:23:31.874 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 10:23:31.884 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 401 0 null 627.4254ms
2025-09-28 10:25:28.793 +03:00 [INF] Starting database seeding.
2025-09-28 10:25:30.278 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:25:34.561 +03:00 [INF] Executed DbCommand (298ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:25:34.818 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:25:34.850 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:25:34.938 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 10:25:35.048 +03:00 [INF] Database seeding finished successfully.
2025-09-28 10:25:36.794 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 10:25:36.796 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 10:25:37.073 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 10:25:37.107 +03:00 [INF] Hosting environment: Development
2025-09-28 10:25:37.434 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 10:25:37.537 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/index.html - null null
2025-09-28 10:25:38.067 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/index.html - 200 null text/html;charset=utf-8 544.2583ms
2025-09-28 10:25:38.085 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_vs/browserLink - null null
2025-09-28 10:25:38.085 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - null null
2025-09-28 10:25:38.143 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_framework/aspnetcore-browser-refresh.js - 200 16539 application/javascript; charset=utf-8 57.3436ms
2025-09-28 10:25:38.212 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/_vs/browserLink - 200 null text/javascript; charset=UTF-8 127.4015ms
2025-09-28 10:25:38.362 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - null null
2025-09-28 10:25:38.658 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7266/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 295.8405ms
2025-09-28 10:25:43.421 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 10:25:43.455 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 34.1281ms
2025-09-28 10:25:43.476 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 10:25:46.283 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:25:46 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 10:25:46.323 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:25:46 AM'.
2025-09-28 10:25:46.338 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 10:25:46.356 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 10:25:46.361 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 401 0 null 2885.0636ms
2025-09-28 10:31:59.647 +03:00 [INF] Starting database seeding.
2025-09-28 10:32:00.335 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:32:03.053 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:32:03.218 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:32:03.230 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:32:03.253 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 10:32:03.338 +03:00 [INF] Database seeding finished successfully.
2025-09-28 10:32:03.985 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 10:32:03.990 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 10:32:04.244 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 10:32:04.253 +03:00 [INF] Hosting environment: Development
2025-09-28 10:32:04.265 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 10:32:11.644 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 10:32:11.778 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 149.0678ms
2025-09-28 10:32:11.866 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 10:32:12.074 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:32:12 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 10:32:12.101 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:32:12 AM'.
2025-09-28 10:32:12.115 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 10:32:12.133 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 10:32:12.141 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 401 0 application/problem+json 275.6696ms
2025-09-28 10:33:38.486 +03:00 [INF] Starting database seeding.
2025-09-28 10:33:39.013 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:33:41.346 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:33:41.450 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:33:41.461 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:33:41.479 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 10:33:41.526 +03:00 [INF] Database seeding finished successfully.
2025-09-28 10:33:42.294 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 10:33:42.299 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 10:33:42.460 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 10:33:42.464 +03:00 [INF] Hosting environment: Development
2025-09-28 10:33:42.466 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 10:33:58.216 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 10:33:58.490 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 276.4055ms
2025-09-28 10:33:58.624 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 10:33:59.079 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:33:59 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 10:33:59.167 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:33:59 AM'.
2025-09-28 10:33:59.200 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 10:33:59.235 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 10:33:59.250 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 401 0 null 627.0613ms
2025-09-28 10:34:34.521 +03:00 [INF] Starting database seeding.
2025-09-28 10:34:35.186 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:34:38.380 +03:00 [INF] Executed DbCommand (106ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:34:38.559 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:34:38.568 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:34:38.592 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 10:34:38.650 +03:00 [INF] Database seeding finished successfully.
2025-09-28 10:34:39.582 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 10:34:39.585 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 10:34:39.975 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 10:34:39.982 +03:00 [INF] Hosting environment: Development
2025-09-28 10:34:39.987 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 10:58:57.628 +03:00 [INF] Starting database seeding.
2025-09-28 10:58:58.369 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:59:14.227 +03:00 [INF] Starting database seeding.
2025-09-28 10:59:14.775 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 10:59:17.539 +03:00 [INF] Executed DbCommand (99ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:59:17.716 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:59:17.728 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 10:59:17.763 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 10:59:17.853 +03:00 [INF] Database seeding finished successfully.
2025-09-28 10:59:18.485 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 10:59:18.488 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 10:59:18.723 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 10:59:18.727 +03:00 [INF] Hosting environment: Development
2025-09-28 10:59:18.731 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 10:59:29.724 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 10:59:29.836 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 109.3597ms
2025-09-28 10:59:29.913 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 10:59:30.112 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:59:30 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 10:59:30.146 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/27/2025 4:42:20 PM', Current time (UTC): '9/28/2025 7:59:30 AM'.
2025-09-28 10:59:30.163 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 11:01:17.706 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 11:01:17.719 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 401 0 null 107805.5868ms
2025-09-28 11:02:46.418 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Accounts/Login - application/json 73
2025-09-28 11:02:46.426 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Accounts/Login - 307 0 null 8.4906ms
2025-09-28 11:02:46.433 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Accounts/Login - application/json 73
2025-09-28 11:02:46.468 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:02:46.471 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:02:46.474 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:02:46.479 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:02:46.482 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:02:46.484 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:02:46.493 +03:00 [INF] Incomming Request: POST /api/Accounts/Login
2025-09-28 11:02:46.497 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.AccountsController.Login (LibraryManagementSystem.API)'
2025-09-28 11:02:46.541 +03:00 [INF] Route matched with {action = "Login", controller = "Accounts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LibraryManagementSystem.Business.Dtos.AccountDtos.LoginDto) on controller LibraryManagementSystem.API.Controllers.AccountsController (LibraryManagementSystem.API).
2025-09-28 11:02:46.930 +03:00 [INF] Executing an action Login on controller Accounts.
2025-09-28 11:02:47.040 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-09-28 11:02:47.465 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-09-28 11:02:47.510 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-09-28 11:02:47.534 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 11:02:47.805 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p17='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p18='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 256), @p7='?' (Size = 256), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [LockoutEnabled] = @p4, [LockoutEnd] = @p5, [NormalizedEmail] = @p6, [NormalizedUserName] = @p7, [PasswordHash] = @p8, [PersonId] = @p9, [PhoneNumber] = @p10, [PhoneNumberConfirmed] = @p11, [RefreshToken] = @p12, [RefreshTokenExpiryTime] = @p13, [SecurityStamp] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-09-28 11:02:47.870 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto'.
2025-09-28 11:02:47.983 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.AccountsController.Login (LibraryManagementSystem.API) in 1428.8858ms
2025-09-28 11:02:47.988 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.AccountsController.Login (LibraryManagementSystem.API)'
2025-09-28 11:02:47.992 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:02:48.000 +03:00 [INF] Generating expiration headers.
2025-09-28 11:02:48.002 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:03:48 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:02:48.007 +03:00 [INF] Generating Validation headers.
2025-09-28 11:02:48.027 +03:00 [INF] Validation headers generated. ETag: Strong, "966A7BD498A6202D5C7DF74CD0339005". Last-Modified: Sun, 28 Sep 2025 08:02:48 GMT
2025-09-28 11:02:48.031 +03:00 [INF] Generating Vary header.
2025-09-28 11:02:48.032 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:02:48.047 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Accounts/Login - 200 null application/json; charset=utf-8 1614.401ms
2025-09-28 11:03:24.178 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 11:03:24.195 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 17.2323ms
2025-09-28 11:03:24.202 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 11:03:24.248 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:03:24.253 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:03:24.255 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:03:24.257 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:03:24.260 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:03:24.264 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:03:24.267 +03:00 [INF] Incomming Request: GET /api/Persons/1
2025-09-28 11:03:24.270 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:03:24.279 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:03:24.296 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:03:24.408 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:03:24.440 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:03:24.452 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 164.0263ms
2025-09-28 11:03:24.457 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:03:24.459 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:03:24.462 +03:00 [INF] Generating expiration headers.
2025-09-28 11:03:24.463 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:04:24 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:03:24.465 +03:00 [INF] Generating Validation headers.
2025-09-28 11:03:24.468 +03:00 [INF] Validation headers generated. ETag: Strong, "96760E6A282DA0720171D9EC85FA7893". Last-Modified: Sun, 28 Sep 2025 08:03:24 GMT
2025-09-28 11:03:24.470 +03:00 [INF] Generating Vary header.
2025-09-28 11:03:24.472 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:03:24.475 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 200 null application/json; charset=utf-8 273.5205ms
2025-09-28 11:03:29.609 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 11:03:29.630 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 20.6385ms
2025-09-28 11:03:29.635 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 11:03:29.684 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:03:29.691 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:03:29.699 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:03:29.707 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:03:29.716 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:03:29.724 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:03:29.732 +03:00 [INF] Incomming Request: GET /api/Persons/1
2025-09-28 11:03:29.743 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:03:29.758 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:03:29.781 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:03:29.796 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:03:29.836 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:03:29.850 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 71.8089ms
2025-09-28 11:03:29.863 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:03:29.879 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:03:29.888 +03:00 [INF] Generating expiration headers.
2025-09-28 11:03:29.896 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:04:29 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:03:29.906 +03:00 [INF] Generating Validation headers.
2025-09-28 11:03:29.916 +03:00 [INF] Validation headers generated. ETag: Strong, "96760E6A282DA0720171D9EC85FA7893". Last-Modified: Sun, 28 Sep 2025 08:03:29 GMT
2025-09-28 11:03:29.927 +03:00 [INF] Generating Vary header.
2025-09-28 11:03:29.936 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:03:29.947 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 200 null application/json; charset=utf-8 312.5086ms
2025-09-28 11:03:31.701 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 11:03:31.710 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 8.2877ms
2025-09-28 11:03:31.711 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 11:03:31.722 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:03:31.723 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:03:31.725 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:03:31.727 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:03:31.729 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:03:31.732 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:03:31.734 +03:00 [INF] Incomming Request: GET /api/Persons/1
2025-09-28 11:03:31.736 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:03:31.739 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:03:31.752 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:03:31.758 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:03:31.767 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:03:31.771 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 27.4292ms
2025-09-28 11:03:31.774 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:03:31.776 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:03:31.778 +03:00 [INF] Generating expiration headers.
2025-09-28 11:03:31.780 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:04:31 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:03:31.782 +03:00 [INF] Generating Validation headers.
2025-09-28 11:03:31.785 +03:00 [INF] Validation headers generated. ETag: Strong, "96760E6A282DA0720171D9EC85FA7893". Last-Modified: Sun, 28 Sep 2025 08:03:31 GMT
2025-09-28 11:03:31.787 +03:00 [INF] Generating Vary header.
2025-09-28 11:03:31.789 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:03:31.791 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 200 null application/json; charset=utf-8 79.5096ms
2025-09-28 11:03:35.823 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - null null
2025-09-28 11:03:35.837 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 14.0208ms
2025-09-28 11:03:35.839 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - null null
2025-09-28 11:03:35.853 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:03:35.855 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:03:35.856 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:03:35.858 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:03:35.860 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:03:35.863 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:03:35.866 +03:00 [INF] Incomming Request: GET /api/Persons/1
2025-09-28 11:03:35.869 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:03:35.872 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:03:35.879 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:03:35.883 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:03:35.899 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:03:35.904 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 25.6643ms
2025-09-28 11:03:35.907 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:03:35.911 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:03:35.916 +03:00 [INF] Generating expiration headers.
2025-09-28 11:03:35.919 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:04:35 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:03:35.921 +03:00 [INF] Generating Validation headers.
2025-09-28 11:03:35.922 +03:00 [INF] Validation headers generated. ETag: Strong, "96760E6A282DA0720171D9EC85FA7893". Last-Modified: Sun, 28 Sep 2025 08:03:35 GMT
2025-09-28 11:03:35.925 +03:00 [INF] Generating Vary header.
2025-09-28 11:03:35.928 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:03:35.931 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 200 null application/json; charset=utf-8 91.8463ms
2025-09-28 11:04:19.293 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons - null null
2025-09-28 11:04:19.307 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons - 307 0 null 15.9586ms
2025-09-28 11:04:19.311 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons - null null
2025-09-28 11:04:19.330 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:04:19.332 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:04:19.335 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:04:19.337 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:04:19.339 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:04:19.341 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:04:19.342 +03:00 [INF] Incomming Request: GET /api/Persons
2025-09-28 11:04:19.345 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API)'
2025-09-28 11:04:19.356 +03:00 [INF] Route matched with {action = "GetAll", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(LibraryManagementSystem.Business.Dtos.Shared.PaginationParameters) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:04:19.374 +03:00 [INF] Executing an action GetAll on controller Persons.
2025-09-28 11:04:32.597 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API) in 13231.1556ms
2025-09-28 11:04:32.604 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API)'
2025-09-28 11:04:35.008 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<Person>()
    .OrderBy(p => EF.Property<PersonName>(p, "Name").ToString())' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.CountAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.Shared.PagedList`1.ToPagedList(IQueryable`1 source, Int32 pageNumber, Int32 pageSize)
   at LibraryManagementSystem.DataAccess.Repositories.PersonRepository.GetAllPersonsAsync(PaginationParameters paginationParameters, Boolean trackChanges) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\Repositories\PersonRepository.cs:line 37
   at LibraryManagementSystem.Business.Services.PersonService.GetAllPersonsAsync(PaginationParameters paginationParameters) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\PersonService.cs:line 51
   at LibraryManagementSystem.API.Controllers.PersonsController.GetAll(PaginationParameters pagination) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\PersonsController.cs:line 67
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 11:04:35.152 +03:00 [ERR] An unhandled exception occurred: The LINQ expression 'DbSet<Person>()
    .OrderBy(p => EF.Property<PersonName>(p, "Name").ToString())' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
System.InvalidOperationException: The LINQ expression 'DbSet<Person>()
    .OrderBy(p => EF.Property<PersonName>(p, "Name").ToString())' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.CountAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.Shared.PagedList`1.ToPagedList(IQueryable`1 source, Int32 pageNumber, Int32 pageSize)
   at LibraryManagementSystem.DataAccess.Repositories.PersonRepository.GetAllPersonsAsync(PaginationParameters paginationParameters, Boolean trackChanges) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\Repositories\PersonRepository.cs:line 37
   at LibraryManagementSystem.Business.Services.PersonService.GetAllPersonsAsync(PaginationParameters paginationParameters) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\PersonService.cs:line 51
   at LibraryManagementSystem.API.Controllers.PersonsController.GetAll(PaginationParameters pagination) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\PersonsController.cs:line 67
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 11:04:35.289 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons - 500 null application/problem+json 15978.2984ms
2025-09-28 11:06:03.683 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons - null null
2025-09-28 11:06:03.696 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons - 307 0 null 13.2263ms
2025-09-28 11:06:03.698 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons - null null
2025-09-28 11:06:03.710 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:06:03.712 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:06:03.714 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:06:03.718 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:06:03.720 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:06:03.723 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:06:03.726 +03:00 [INF] Incomming Request: GET /api/Persons
2025-09-28 11:06:03.731 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API)'
2025-09-28 11:06:03.735 +03:00 [INF] Route matched with {action = "GetAll", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(LibraryManagementSystem.Business.Dtos.Shared.PaginationParameters) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:06:03.741 +03:00 [INF] Executing an action GetAll on controller Persons.
2025-09-28 11:12:10.908 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API) in 367167.7577ms
2025-09-28 11:12:10.945 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons - null null
2025-09-28 11:12:10.966 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API)'
2025-09-28 11:12:10.987 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons - 307 0 null 41.8979ms
2025-09-28 11:13:33.260 +03:00 [INF] Starting database seeding.
2025-09-28 11:13:33.810 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 11:13:37.623 +03:00 [INF] Executed DbCommand (145ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 11:13:37.830 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 11:13:37.841 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 11:13:37.868 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 11:13:37.985 +03:00 [INF] Database seeding finished successfully.
2025-09-28 11:13:38.699 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 11:13:38.703 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 11:13:38.988 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 11:13:38.991 +03:00 [INF] Hosting environment: Development
2025-09-28 11:13:38.995 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 11:13:50.683 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons - null null
2025-09-28 11:13:50.808 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons - 307 0 null 136.3506ms
2025-09-28 11:13:50.913 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons - null null
2025-09-28 11:13:51.305 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:13:51.322 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:13:51.328 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:13:51.343 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:13:51.350 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:13:51.358 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:13:51.378 +03:00 [INF] Incomming Request: GET /api/Persons
2025-09-28 11:13:51.391 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API)'
2025-09-28 11:13:51.493 +03:00 [INF] Route matched with {action = "GetAll", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(LibraryManagementSystem.Business.Dtos.Shared.PaginationParameters) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:13:52.033 +03:00 [INF] Executing an action GetAll on controller Persons.
2025-09-28 11:17:14.185 +03:00 [INF] Starting database seeding.
2025-09-28 11:17:14.680 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 11:17:17.369 +03:00 [INF] Executed DbCommand (95ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 11:17:17.532 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 11:17:17.543 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 11:17:17.577 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 11:17:17.659 +03:00 [INF] Database seeding finished successfully.
2025-09-28 11:17:18.347 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 11:17:18.351 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 11:17:18.503 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 11:17:18.505 +03:00 [INF] Hosting environment: Development
2025-09-28 11:17:18.507 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 11:17:18.865 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons - null null
2025-09-28 11:17:19.028 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons - 307 0 null 174.9229ms
2025-09-28 11:17:19.118 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons - null null
2025-09-28 11:17:19.450 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:17:19.460 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:17:19.463 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:17:19.468 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:17:19.470 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:17:19.473 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:17:19.482 +03:00 [INF] Incomming Request: GET /api/Persons
2025-09-28 11:17:19.486 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API)'
2025-09-28 11:17:19.538 +03:00 [INF] Route matched with {action = "GetAll", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(LibraryManagementSystem.Business.Dtos.Shared.PaginationParameters) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:17:19.837 +03:00 [INF] Executing an action GetAll on controller Persons.
2025-09-28 11:17:20.023 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Persons] AS [p]
2025-09-28 11:17:20.076 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Persons] AS [p]
ORDER BY [p].[FirstName], [p].[LastName]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-09-28 11:17:20.146 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.Shared.PagedListDto`1[[LibraryManagementSystem.Business.Dtos.PersonDtos.PersonSummaryDto, LibraryManagementSystem.Business, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-28 11:17:20.170 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API) in 613.7067ms
2025-09-28 11:17:20.176 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API)'
2025-09-28 11:17:20.180 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:17:20.185 +03:00 [INF] Generating expiration headers.
2025-09-28 11:17:20.189 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:18:20 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:17:20.194 +03:00 [INF] Generating Validation headers.
2025-09-28 11:17:20.215 +03:00 [INF] Validation headers generated. ETag: Strong, "D9C5B46EFE55431227049364287C6376". Last-Modified: Sun, 28 Sep 2025 08:17:20 GMT
2025-09-28 11:17:20.219 +03:00 [INF] Generating Vary header.
2025-09-28 11:17:20.221 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:17:20.233 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons - 200 null application/json; charset=utf-8 1115.3362ms
2025-09-28 11:18:24.063 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons?pageSize=2&pageNumber=1 - null null
2025-09-28 11:18:24.090 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons?pageSize=2&pageNumber=1 - 307 0 null 27.1783ms
2025-09-28 11:18:24.096 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons?pageSize=2&pageNumber=1 - null null
2025-09-28 11:18:24.114 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:18:24.117 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:18:24.120 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:18:24.122 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:18:24.124 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:18:24.126 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:18:24.129 +03:00 [INF] Incomming Request: GET /api/Persons
2025-09-28 11:18:24.131 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API)'
2025-09-28 11:18:24.136 +03:00 [INF] Route matched with {action = "GetAll", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(LibraryManagementSystem.Business.Dtos.Shared.PaginationParameters) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:18:24.155 +03:00 [INF] Executing an action GetAll on controller Persons.
2025-09-28 11:18:24.188 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Persons] AS [p]
2025-09-28 11:18:24.203 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Persons] AS [p]
ORDER BY [p].[FirstName], [p].[LastName]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-09-28 11:18:24.213 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.Shared.PagedListDto`1[[LibraryManagementSystem.Business.Dtos.PersonDtos.PersonSummaryDto, LibraryManagementSystem.Business, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-28 11:18:24.219 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API) in 76.3015ms
2025-09-28 11:18:24.224 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetAll (LibraryManagementSystem.API)'
2025-09-28 11:18:24.228 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:18:24.231 +03:00 [INF] Generating expiration headers.
2025-09-28 11:18:24.236 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:19:24 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:18:24.239 +03:00 [INF] Generating Validation headers.
2025-09-28 11:18:24.243 +03:00 [INF] Validation headers generated. ETag: Strong, "6C0B541FAB5B40BA138EFCE433C9DBDE". Last-Modified: Sun, 28 Sep 2025 08:18:24 GMT
2025-09-28 11:18:24.247 +03:00 [INF] Generating Vary header.
2025-09-28 11:18:24.251 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:18:24.255 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons?pageSize=2&pageNumber=1 - 200 null application/json; charset=utf-8 158.9665ms
2025-09-28 11:20:11.951 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Persons/GetByIds - application/json 23
2025-09-28 11:20:11.966 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Persons/GetByIds - 307 0 null 18.1473ms
2025-09-28 11:20:11.970 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Persons/GetByIds - application/json 23
2025-09-28 11:20:12.001 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:20:12.005 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:20:12.008 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:20:12.009 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:20:12.013 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:20:12.015 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:20:12.017 +03:00 [INF] Incomming Request: POST /api/Persons/GetByIds
2025-09-28 11:20:12.022 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetByIds (LibraryManagementSystem.API)'
2025-09-28 11:20:12.031 +03:00 [INF] Route matched with {action = "GetByIds", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByIds(LibraryManagementSystem.Business.Dtos.Shared.GetByIdsDto) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:20:12.098 +03:00 [INF] Executing an action GetByIds on controller Persons.
2025-09-28 11:20:12.257 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Persons] AS [p]
WHERE [p].[Id] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-09-28 11:20:12.287 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[LibraryManagementSystem.Business.Dtos.PersonDtos.PersonSummaryDto, LibraryManagementSystem.Business, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-28 11:20:12.300 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetByIds (LibraryManagementSystem.API) in 260.3614ms
2025-09-28 11:20:12.312 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetByIds (LibraryManagementSystem.API)'
2025-09-28 11:20:12.321 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:20:12.327 +03:00 [INF] Generating expiration headers.
2025-09-28 11:20:12.332 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:21:12 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:20:12.337 +03:00 [INF] Generating Validation headers.
2025-09-28 11:20:12.339 +03:00 [INF] Validation headers generated. ETag: Strong, "047E91122E0087CFC1B1A50B44448431". Last-Modified: Sun, 28 Sep 2025 08:20:12 GMT
2025-09-28 11:20:12.342 +03:00 [INF] Generating Vary header.
2025-09-28 11:20:12.343 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:20:12.346 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Persons/GetByIds - 200 null application/json; charset=utf-8 376.2844ms
2025-09-28 11:21:30.956 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Persons - application/json 57
2025-09-28 11:21:30.981 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Persons - 307 0 null 25.9401ms
2025-09-28 11:21:30.984 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Persons - application/json 57
2025-09-28 11:21:30.997 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:21:30.999 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:21:31.001 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:21:31.004 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:21:31.006 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:21:31.009 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:21:31.011 +03:00 [INF] Incomming Request: POST /api/Persons
2025-09-28 11:21:31.014 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Create (LibraryManagementSystem.API)'
2025-09-28 11:21:31.025 +03:00 [INF] Route matched with {action = "Create", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(LibraryManagementSystem.Business.Dtos.PersonDtos.CreatePersonDto) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:21:31.040 +03:00 [INF] Executing an action Create on controller Persons.
2025-09-28 11:21:31.650 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Persons] ([FirstName], [LastName])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2025-09-28 11:21:31.769 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:21:31.857 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.Create (LibraryManagementSystem.API) in 824.2031ms
2025-09-28 11:21:31.873 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Create (LibraryManagementSystem.API)'
2025-09-28 11:21:31.886 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:21:31.895 +03:00 [INF] Generating expiration headers.
2025-09-28 11:21:31.904 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:22:31 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:21:31.920 +03:00 [INF] Generating Validation headers.
2025-09-28 11:21:31.941 +03:00 [INF] Validation headers generated. ETag: Strong, "7CB8B376E53658AAB6429D7C9F1EB8FA". Last-Modified: Sun, 28 Sep 2025 08:21:31 GMT
2025-09-28 11:21:31.960 +03:00 [INF] Generating Vary header.
2025-09-28 11:21:31.968 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:21:31.979 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Persons - 201 null application/json; charset=utf-8 995.7383ms
2025-09-28 11:24:20.052 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Persons/Collection - application/json 396
2025-09-28 11:24:20.069 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Persons/Collection - 307 0 null 18.1501ms
2025-09-28 11:24:20.070 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Persons/Collection - application/json 396
2025-09-28 11:24:20.081 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:24:20.082 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:24:20.084 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:24:20.087 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:24:20.089 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:24:20.091 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:24:20.093 +03:00 [INF] Incomming Request: POST /api/Persons/Collection
2025-09-28 11:24:20.097 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 11:24:20.104 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.PersonDtos.CreatePersonDto]) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:24:20.133 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-28 11:24:20.191 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.CreateCollection (LibraryManagementSystem.API) in 79.4696ms
2025-09-28 11:24:20.199 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 11:24:20.207 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:24:20.212 +03:00 [INF] Generating expiration headers.
2025-09-28 11:24:20.215 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:25:20 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:24:20.220 +03:00 [INF] Not generating Validation headers as the response status code does not indicate success.
2025-09-28 11:24:20.222 +03:00 [INF] Generating Vary header.
2025-09-28 11:24:20.223 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:24:20.226 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Persons/Collection - 400 null application/problem+json; charset=utf-8 155.5997ms
2025-09-28 11:24:44.179 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Persons/Collection - application/json 395
2025-09-28 11:24:44.192 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Persons/Collection - 307 0 null 41.129ms
2025-09-28 11:24:44.201 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Persons/Collection - application/json 395
2025-09-28 11:24:44.214 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:24:44.216 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:24:44.219 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:24:44.222 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:24:44.225 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:24:44.227 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:24:44.229 +03:00 [INF] Incomming Request: POST /api/Persons/Collection
2025-09-28 11:24:44.232 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 11:24:44.235 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.PersonDtos.CreatePersonDto]) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:24:44.250 +03:00 [INF] Executing an action CreateCollection on controller Persons.
2025-09-28 11:24:44.326 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 100), @p2='?' (Size = 100), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (Size = 100), @p6='?' (Size = 100), @p7='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Persons] USING (
VALUES (@p0, @p1, 0),
(@p2, @p3, 1),
(@p4, @p5, 2),
(@p6, @p7, 3)) AS i ([FirstName], [LastName], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([FirstName], [LastName])
VALUES (i.[FirstName], i.[LastName])
OUTPUT INSERTED.[Id], i._Position;
2025-09-28 11:24:44.344 +03:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto, LibraryManagementSystem.Business, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-28 11:24:44.349 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.CreateCollection (LibraryManagementSystem.API) in 106.6702ms
2025-09-28 11:24:44.353 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 11:24:44.357 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:24:44.359 +03:00 [INF] Generating expiration headers.
2025-09-28 11:24:44.361 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:25:44 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:24:44.364 +03:00 [INF] Generating Validation headers.
2025-09-28 11:24:44.367 +03:00 [INF] Validation headers generated. ETag: Strong, "84D96AA70C4FF5CB3036483B17A2ECDA". Last-Modified: Sun, 28 Sep 2025 08:24:44 GMT
2025-09-28 11:24:44.370 +03:00 [INF] Generating Vary header.
2025-09-28 11:24:44.372 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:24:44.376 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Persons/Collection - 201 null application/json; charset=utf-8 175.0569ms
2025-09-28 11:27:02.295 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Persons/1 - application/json 57
2025-09-28 11:27:02.312 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Persons/1 - 307 0 null 16.9174ms
2025-09-28 11:27:02.314 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Persons/1 - application/json 57
2025-09-28 11:27:02.330 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:27:02.332 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:27:02.335 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:27:02.338 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:27:02.341 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 11:27:02.343 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:27:02.346 +03:00 [INF] Incomming Request: PUT /api/Persons/1
2025-09-28 11:27:02.350 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API)'
2025-09-28 11:27:02.363 +03:00 [INF] Route matched with {action = "Update", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, LibraryManagementSystem.Business.Dtos.PersonDtos.UpdatePersonDto) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:27:02.375 +03:00 [INF] Executing an action Update on controller Persons.
2025-09-28 11:27:02.401 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Persons] AS [p]
WHERE [p].[Id] = @__id_0
2025-09-28 11:27:02.425 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-28 11:27:02.429 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API) in 56.9436ms
2025-09-28 11:27:02.438 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API)'
2025-09-28 11:27:02.440 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:27:02.443 +03:00 [INF] Generating expiration headers.
2025-09-28 11:27:02.445 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:28:02 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:27:02.449 +03:00 [INF] Generating Validation headers.
2025-09-28 11:27:02.453 +03:00 [INF] Validation headers generated. ETag: Strong, "CA25B05FBE667CF267E7B549AA1EAA91". Last-Modified: Sun, 28 Sep 2025 08:27:02 GMT
2025-09-28 11:27:02.455 +03:00 [INF] Generating Vary header.
2025-09-28 11:27:02.459 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:27:02.462 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Persons/1 - 204 null null 147.4172ms
2025-09-28 11:27:13.426 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - application/json 57
2025-09-28 11:27:13.433 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 6.4773ms
2025-09-28 11:27:13.434 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - application/json 57
2025-09-28 11:27:13.445 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:27:13.447 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:27:13.449 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:27:13.451 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:27:13.454 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:27:13.459 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:27:13.461 +03:00 [INF] Incomming Request: GET /api/Persons/1
2025-09-28 11:27:13.464 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:27:13.473 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:27:13.481 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:27:13.596 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:27:13.621 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:27:13.633 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 152.9137ms
2025-09-28 11:27:13.645 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:27:13.649 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:27:13.652 +03:00 [INF] Generating expiration headers.
2025-09-28 11:27:13.655 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:28:13 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:27:13.657 +03:00 [INF] Generating Validation headers.
2025-09-28 11:27:13.660 +03:00 [INF] Validation headers generated. ETag: Strong, "96760E6A282DA0720171D9EC85FA7893". Last-Modified: Sun, 28 Sep 2025 08:27:13 GMT
2025-09-28 11:27:13.664 +03:00 [INF] Generating Vary header.
2025-09-28 11:27:13.666 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:27:13.669 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 200 null application/json; charset=utf-8 234.2701ms
2025-09-28 11:27:28.126 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/11 - application/json 57
2025-09-28 11:27:28.134 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/11 - 307 0 null 8.4449ms
2025-09-28 11:27:28.135 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/11 - application/json 57
2025-09-28 11:27:28.153 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:27:28.156 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:27:28.159 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:27:28.161 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:27:28.165 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:27:28.168 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:27:28.171 +03:00 [INF] Incomming Request: GET /api/Persons/11
2025-09-28 11:27:28.174 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:27:28.179 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:27:28.185 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:27:28.191 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:27:28.205 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:27:28.212 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 28.1006ms
2025-09-28 11:27:28.217 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:27:28.223 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:27:28.228 +03:00 [INF] Generating expiration headers.
2025-09-28 11:27:28.232 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:28:28 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:27:28.235 +03:00 [INF] Generating Validation headers.
2025-09-28 11:27:28.239 +03:00 [INF] Validation headers generated. ETag: Strong, "2A2E0244257B19617E24CF852D38A186". Last-Modified: Sun, 28 Sep 2025 08:27:28 GMT
2025-09-28 11:27:28.244 +03:00 [INF] Generating Vary header.
2025-09-28 11:27:28.246 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:27:28.249 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/11 - 200 null application/json; charset=utf-8 113.7145ms
2025-09-28 11:27:43.302 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Persons/11 - application/json 57
2025-09-28 11:27:43.313 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Persons/11 - 307 0 null 11.3324ms
2025-09-28 11:27:43.316 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Persons/11 - application/json 57
2025-09-28 11:27:43.339 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:27:43.342 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:27:43.344 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:27:43.347 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:27:43.351 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 11:27:43.353 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:27:43.356 +03:00 [INF] Incomming Request: PUT /api/Persons/11
2025-09-28 11:27:43.358 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API)'
2025-09-28 11:27:43.362 +03:00 [INF] Route matched with {action = "Update", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, LibraryManagementSystem.Business.Dtos.PersonDtos.UpdatePersonDto) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:27:43.371 +03:00 [INF] Executing an action Update on controller Persons.
2025-09-28 11:27:43.376 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Persons] AS [p]
WHERE [p].[Id] = @__id_0
2025-09-28 11:27:43.385 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-28 11:27:43.389 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API) in 19.2918ms
2025-09-28 11:27:43.394 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API)'
2025-09-28 11:27:43.398 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:27:43.401 +03:00 [INF] Generating expiration headers.
2025-09-28 11:27:43.405 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:28:43 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:27:43.408 +03:00 [INF] Generating Validation headers.
2025-09-28 11:27:43.411 +03:00 [INF] Validation headers generated. ETag: Strong, "80228221064C2D494901F8AE78A0E31C". Last-Modified: Sun, 28 Sep 2025 08:27:43 GMT
2025-09-28 11:27:43.415 +03:00 [INF] Generating Vary header.
2025-09-28 11:27:43.418 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:27:43.420 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Persons/11 - 204 null null 104.7331ms
2025-09-28 11:27:55.865 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/11 - application/json 57
2025-09-28 11:27:55.878 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/11 - 307 0 null 12.598ms
2025-09-28 11:27:55.881 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/11 - application/json 57
2025-09-28 11:27:55.906 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:27:55.910 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:27:55.915 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:27:55.920 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:27:55.927 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:27:55.932 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:27:55.938 +03:00 [INF] Incomming Request: GET /api/Persons/11
2025-09-28 11:27:55.946 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:27:55.957 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:27:55.971 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:27:55.982 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:27:56.012 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:27:56.023 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 52.9139ms
2025-09-28 11:27:56.031 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:27:56.038 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:27:56.041 +03:00 [INF] Generating expiration headers.
2025-09-28 11:27:56.046 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:28:56 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:27:56.051 +03:00 [INF] Generating Validation headers.
2025-09-28 11:27:56.054 +03:00 [INF] Validation headers generated. ETag: Strong, "2A2E0244257B19617E24CF852D38A186". Last-Modified: Sun, 28 Sep 2025 08:27:56 GMT
2025-09-28 11:27:56.060 +03:00 [INF] Generating Vary header.
2025-09-28 11:27:56.063 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:27:56.067 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/11 - 200 null application/json; charset=utf-8 186.5722ms
2025-09-28 11:31:24.060 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Persons/11 - application/json 57
2025-09-28 11:31:24.092 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Persons/11 - 307 0 null 33.8133ms
2025-09-28 11:31:24.096 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Persons/11 - application/json 57
2025-09-28 11:31:24.121 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:31:24.125 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:31:24.131 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:31:24.136 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:31:24.140 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 11:31:24.143 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:31:24.145 +03:00 [INF] Incomming Request: PUT /api/Persons/11
2025-09-28 11:31:24.149 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API)'
2025-09-28 11:31:24.153 +03:00 [INF] Route matched with {action = "Update", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, LibraryManagementSystem.Business.Dtos.PersonDtos.UpdatePersonDto) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:31:24.162 +03:00 [INF] Executing an action Update on controller Persons.
2025-09-28 11:32:11.194 +03:00 [INF] Starting database seeding.
2025-09-28 11:32:11.864 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 11:32:14.992 +03:00 [INF] Executed DbCommand (126ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 11:32:15.368 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 11:32:15.376 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 11:32:15.419 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 11:32:15.534 +03:00 [INF] Database seeding finished successfully.
2025-09-28 11:32:16.697 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 11:32:16.700 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 11:32:17.002 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 11:32:17.005 +03:00 [INF] Hosting environment: Development
2025-09-28 11:32:17.007 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 11:32:22.730 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Persons/11 - application/json 57
2025-09-28 11:32:22.914 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Persons/11 - 307 0 null 197.3367ms
2025-09-28 11:32:23.032 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Persons/11 - application/json 57
2025-09-28 11:32:23.433 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:32:23.436 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:32:23.438 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:32:23.444 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:32:23.452 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 11:32:23.454 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:32:23.483 +03:00 [INF] Incomming Request: PUT /api/Persons/11
2025-09-28 11:32:23.503 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API)'
2025-09-28 11:32:23.566 +03:00 [INF] Route matched with {action = "Update", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, LibraryManagementSystem.Business.Dtos.PersonDtos.UpdatePersonDto) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:32:23.926 +03:00 [INF] Executing an action Update on controller Persons.
2025-09-28 11:32:24.143 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Persons] AS [p]
WHERE [p].[Id] = @__id_0
2025-09-28 11:32:24.461 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Persons] SET [LastName] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-09-28 11:32:24.499 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-28 11:32:24.506 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API) in 916.398ms
2025-09-28 11:32:24.513 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Update (LibraryManagementSystem.API)'
2025-09-28 11:32:24.517 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:32:24.525 +03:00 [INF] Generating expiration headers.
2025-09-28 11:32:24.535 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:33:24 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:32:24.548 +03:00 [INF] Generating Validation headers.
2025-09-28 11:32:24.575 +03:00 [INF] Validation headers generated. ETag: Strong, "80228221064C2D494901F8AE78A0E31C". Last-Modified: Sun, 28 Sep 2025 08:32:24 GMT
2025-09-28 11:32:24.580 +03:00 [INF] Generating Vary header.
2025-09-28 11:32:24.583 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:32:24.604 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Persons/11 - 204 null null 1572.5487ms
2025-09-28 11:32:30.709 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/11 - application/json 57
2025-09-28 11:32:30.745 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/11 - 307 0 null 36.1156ms
2025-09-28 11:32:30.753 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/11 - application/json 57
2025-09-28 11:32:30.801 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:32:30.808 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:32:30.816 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:32:30.824 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:32:30.832 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:32:30.841 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:32:30.851 +03:00 [INF] Incomming Request: GET /api/Persons/11
2025-09-28 11:32:30.861 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:32:30.888 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:32:30.923 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:32:31.285 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:32:31.380 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:32:31.422 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 514.3501ms
2025-09-28 11:32:31.438 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:32:31.449 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:32:31.460 +03:00 [INF] Generating expiration headers.
2025-09-28 11:32:31.468 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:33:31 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:32:31.476 +03:00 [INF] Generating Validation headers.
2025-09-28 11:32:31.487 +03:00 [INF] Validation headers generated. ETag: Strong, "DB6F43BF15C176E4A13430E1D3E26701". Last-Modified: Sun, 28 Sep 2025 08:32:31 GMT
2025-09-28 11:32:31.495 +03:00 [INF] Generating Vary header.
2025-09-28 11:32:31.500 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:32:31.506 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/11 - 200 null application/json; charset=utf-8 752.6491ms
2025-09-28 11:33:10.205 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5132/api/Persons/11 - application/json 57
2025-09-28 11:33:10.227 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5132/api/Persons/11 - 307 0 null 23.6053ms
2025-09-28 11:33:10.230 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7266/api/Persons/11 - application/json 57
2025-09-28 11:33:10.253 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:33:10.256 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:33:10.259 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:33:10.263 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:33:10.267 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:33:10.272 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:33:10.277 +03:00 [INF] Incomming Request: DELETE /api/Persons/11
2025-09-28 11:33:10.285 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API)'
2025-09-28 11:33:10.298 +03:00 [INF] Route matched with {action = "Delete", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:33:10.327 +03:00 [INF] Executing an action Delete on controller Persons.
2025-09-28 11:33:10.371 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:33:10.466 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Persons]
OUTPUT 1
WHERE [Id] = @p0;
2025-09-28 11:33:10.486 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-28 11:33:10.491 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API) in 179.273ms
2025-09-28 11:33:10.498 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API)'
2025-09-28 11:33:10.503 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:33:10.506 +03:00 [INF] Generating expiration headers.
2025-09-28 11:33:10.508 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:34:10 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:33:10.512 +03:00 [INF] Generating Validation headers.
2025-09-28 11:33:10.514 +03:00 [INF] Validation headers generated. ETag: Strong, "80228221064C2D494901F8AE78A0E31C". Last-Modified: Sun, 28 Sep 2025 08:33:10 GMT
2025-09-28 11:33:10.517 +03:00 [INF] Generating Vary header.
2025-09-28 11:33:10.519 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:33:10.521 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7266/api/Persons/11 - 204 null null 291.0567ms
2025-09-28 11:33:16.743 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/11 - application/json 57
2025-09-28 11:33:16.761 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/11 - 307 0 null 18.1574ms
2025-09-28 11:33:16.766 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/11 - application/json 57
2025-09-28 11:33:16.809 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:33:16.816 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:33:16.826 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:33:16.837 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:33:16.846 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:33:16.854 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:33:16.865 +03:00 [INF] Incomming Request: GET /api/Persons/11
2025-09-28 11:33:16.880 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:33:16.893 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:33:16.921 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:33:16.939 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:33:21.570 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 4651.6154ms
2025-09-28 11:33:21.585 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:33:25.722 +03:00 [ERR] An unhandled exception has occurred while executing the request.
LibraryManagementSystem.Business.Exceptions.NotFoundException: Person with id 11 not found.
   at LibraryManagementSystem.Business.Services.PersonService.ThrowNotFoundExceptionIfPersonNotExist(Int32 id, Person person) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\PersonService.cs:line 146
   at LibraryManagementSystem.Business.Services.PersonService.GetPersonByIdAsync(Int32 id) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\PersonService.cs:line 38
   at LibraryManagementSystem.API.Controllers.PersonsController.GetById(Int32 id) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\PersonsController.cs:line 47
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 11:33:25.862 +03:00 [WRN] A Not Found exception has occured: Person with id 11 not found.
LibraryManagementSystem.Business.Exceptions.NotFoundException: Person with id 11 not found.
   at LibraryManagementSystem.Business.Services.PersonService.ThrowNotFoundExceptionIfPersonNotExist(Int32 id, Person person) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\PersonService.cs:line 146
   at LibraryManagementSystem.Business.Services.PersonService.GetPersonByIdAsync(Int32 id) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\PersonService.cs:line 38
   at LibraryManagementSystem.API.Controllers.PersonsController.GetById(Int32 id) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\PersonsController.cs:line 47
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 11:33:25.970 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/11 - 404 null application/problem+json 9203.8554ms
2025-09-28 11:33:51.375 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/1 - application/json 57
2025-09-28 11:33:51.390 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/1 - 307 0 null 15.2943ms
2025-09-28 11:33:51.393 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/1 - application/json 57
2025-09-28 11:33:51.410 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:33:51.412 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:33:51.415 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:33:51.417 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:33:51.420 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:33:51.422 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:33:51.424 +03:00 [INF] Incomming Request: GET /api/Persons/1
2025-09-28 11:33:51.427 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:33:51.430 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:33:51.437 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:33:51.441 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:33:51.456 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:33:51.460 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 23.4585ms
2025-09-28 11:33:51.464 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:33:51.468 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:33:51.470 +03:00 [INF] Generating expiration headers.
2025-09-28 11:33:51.472 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:34:51 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:33:51.475 +03:00 [INF] Generating Validation headers.
2025-09-28 11:33:51.477 +03:00 [INF] Validation headers generated. ETag: Strong, "96760E6A282DA0720171D9EC85FA7893". Last-Modified: Sun, 28 Sep 2025 08:33:51 GMT
2025-09-28 11:33:51.480 +03:00 [INF] Generating Vary header.
2025-09-28 11:33:51.482 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:33:51.484 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/1 - 200 null application/json; charset=utf-8 92.1164ms
2025-09-28 11:34:00.942 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5132/api/Persons/1 - application/json 57
2025-09-28 11:34:00.953 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5132/api/Persons/1 - 307 0 null 10.6561ms
2025-09-28 11:34:00.955 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7266/api/Persons/1 - application/json 57
2025-09-28 11:34:00.967 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:34:00.968 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:34:00.970 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:34:00.971 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:34:00.973 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:34:00.975 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:34:00.978 +03:00 [INF] Incomming Request: DELETE /api/Persons/1
2025-09-28 11:34:00.981 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API)'
2025-09-28 11:34:00.985 +03:00 [INF] Route matched with {action = "Delete", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:34:00.990 +03:00 [INF] Executing an action Delete on controller Persons.
2025-09-28 11:34:00.994 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:34:01.052 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [Authors]
OUTPUT 1
WHERE [Id] = @p0;
DELETE FROM [Persons]
OUTPUT 1
WHERE [Id] = @p1;
2025-09-28 11:34:01.080 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-28 11:34:01.084 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API) in 94.4796ms
2025-09-28 11:34:01.087 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API)'
2025-09-28 11:34:01.091 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:34:01.094 +03:00 [INF] Generating expiration headers.
2025-09-28 11:34:01.099 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:35:01 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:34:01.102 +03:00 [INF] Generating Validation headers.
2025-09-28 11:34:01.104 +03:00 [INF] Validation headers generated. ETag: Strong, "CA25B05FBE667CF267E7B549AA1EAA91". Last-Modified: Sun, 28 Sep 2025 08:34:01 GMT
2025-09-28 11:34:01.107 +03:00 [INF] Generating Vary header.
2025-09-28 11:34:01.109 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:34:01.112 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7266/api/Persons/1 - 204 null null 157.8561ms
2025-09-28 11:34:39.881 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/2 - application/json 57
2025-09-28 11:34:39.897 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/2 - 307 0 null 18.9919ms
2025-09-28 11:34:39.901 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/2 - application/json 57
2025-09-28 11:34:39.920 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:34:39.922 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:34:39.924 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:34:39.926 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:34:39.927 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:34:39.930 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:34:39.932 +03:00 [INF] Incomming Request: GET /api/Persons/2
2025-09-28 11:34:39.934 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:34:39.937 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:34:39.942 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:34:39.947 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:34:39.959 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:34:39.963 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 21.5868ms
2025-09-28 11:34:39.966 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:34:39.970 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:34:39.972 +03:00 [INF] Generating expiration headers.
2025-09-28 11:34:39.973 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:35:39 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:34:39.975 +03:00 [INF] Generating Validation headers.
2025-09-28 11:34:39.978 +03:00 [INF] Validation headers generated. ETag: Strong, "8474288F9C84D314F61AA4E3BC47ACDC". Last-Modified: Sun, 28 Sep 2025 08:34:39 GMT
2025-09-28 11:34:39.980 +03:00 [INF] Generating Vary header.
2025-09-28 11:34:39.982 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:34:39.985 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/2 - 200 null application/json; charset=utf-8 83.3275ms
2025-09-28 11:34:46.224 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/3 - application/json 57
2025-09-28 11:34:46.237 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/3 - 307 0 null 12.8331ms
2025-09-28 11:34:46.239 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/3 - application/json 57
2025-09-28 11:34:46.266 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:34:46.271 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:34:46.276 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:34:46.281 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:34:46.285 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:34:46.290 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:34:46.297 +03:00 [INF] Incomming Request: GET /api/Persons/3
2025-09-28 11:34:46.304 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:34:46.314 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:34:46.327 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:34:46.335 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:34:46.360 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:34:46.367 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 40.9237ms
2025-09-28 11:34:46.371 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:34:46.375 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:34:46.378 +03:00 [INF] Generating expiration headers.
2025-09-28 11:34:46.380 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:35:46 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:34:46.382 +03:00 [INF] Generating Validation headers.
2025-09-28 11:34:46.385 +03:00 [INF] Validation headers generated. ETag: Strong, "7C70CCEE106F28702A532A9D99F80553". Last-Modified: Sun, 28 Sep 2025 08:34:46 GMT
2025-09-28 11:34:46.387 +03:00 [INF] Generating Vary header.
2025-09-28 11:34:46.389 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:34:46.392 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/3 - 200 null application/json; charset=utf-8 152.552ms
2025-09-28 11:34:52.752 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/4 - application/json 57
2025-09-28 11:34:52.771 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/4 - 307 0 null 19.7728ms
2025-09-28 11:34:52.780 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/4 - application/json 57
2025-09-28 11:34:52.828 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:34:52.836 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 11:34:52.844 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:34:52.852 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:34:52.860 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:34:52.869 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:34:52.878 +03:00 [INF] Incomming Request: GET /api/Persons/4
2025-09-28 11:34:52.888 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:34:52.903 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:34:52.931 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 11:34:52.946 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:34:52.984 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 11:34:52.996 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 66.187ms
2025-09-28 11:34:53.011 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 11:34:53.023 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:34:53.031 +03:00 [INF] Generating expiration headers.
2025-09-28 11:34:53.039 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:35:53 GMT. Cache-Control: public,max-age=60.
2025-09-28 11:34:53.047 +03:00 [INF] Generating Validation headers.
2025-09-28 11:34:53.059 +03:00 [INF] Validation headers generated. ETag: Strong, "143A45A5D9B7938C6950FE083F6B555D". Last-Modified: Sun, 28 Sep 2025 08:34:53 GMT
2025-09-28 11:34:53.071 +03:00 [INF] Generating Vary header.
2025-09-28 11:34:53.079 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:34:53.088 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/4 - 200 null application/json; charset=utf-8 308.6106ms
2025-09-28 11:36:40.773 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5132/api/Persons/4 - application/json 57
2025-09-28 11:36:40.793 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5132/api/Persons/4 - 307 0 null 21.9113ms
2025-09-28 11:36:40.795 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7266/api/Persons/4 - application/json 57
2025-09-28 11:36:40.806 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 11:36:40.808 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 11:36:40.812 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 11:36:40.813 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 11:36:40.815 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 11:36:40.817 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 11:36:40.819 +03:00 [INF] Incomming Request: DELETE /api/Persons/4
2025-09-28 11:36:40.822 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API)'
2025-09-28 11:36:40.825 +03:00 [INF] Route matched with {action = "Delete", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 11:36:40.831 +03:00 [INF] Executing an action Delete on controller Persons.
2025-09-28 11:36:40.836 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 11:36:40.877 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [Borrowers]
OUTPUT 1
WHERE [Id] = @p0;
DELETE FROM [Persons]
OUTPUT 1
WHERE [Id] = @p1;
2025-09-28 11:36:40.899 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-28 11:36:40.904 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API) in 73.3647ms
2025-09-28 11:36:40.913 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API)'
2025-09-28 11:36:40.921 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 11:36:40.927 +03:00 [INF] Generating expiration headers.
2025-09-28 11:36:40.933 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 08:37:40 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 11:36:40.942 +03:00 [INF] Generating Validation headers.
2025-09-28 11:36:40.947 +03:00 [INF] Validation headers generated. ETag: Strong, "76E8F7028B9B2ECF72DF0B7EDB2B7EA1". Last-Modified: Sun, 28 Sep 2025 08:36:40 GMT
2025-09-28 11:36:40.954 +03:00 [INF] Generating Vary header.
2025-09-28 11:36:40.959 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 11:36:40.965 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7266/api/Persons/4 - 204 null null 169.8814ms
2025-09-28 12:03:44.988 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5132/api/Persons/5 - application/json 57
2025-09-28 12:03:45.018 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5132/api/Persons/5 - 307 0 null 29.9755ms
2025-09-28 12:03:45.020 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7266/api/Persons/5 - application/json 57
2025-09-28 12:03:45.035 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:03:45.037 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:03:45.039 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:03:45.042 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:03:45.044 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:03:45.047 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:03:45.048 +03:00 [INF] Incomming Request: DELETE /api/Persons/5
2025-09-28 12:03:45.051 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API)'
2025-09-28 12:03:45.056 +03:00 [INF] Route matched with {action = "Delete", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 12:03:45.062 +03:00 [INF] Executing an action Delete on controller Persons.
2025-09-28 12:03:45.081 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[PersonId], [a0].[Id], [a0].[Biography], [a0].[PersonId]
FROM [Persons] AS [p]
LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
WHERE [p].[Id] = @__id_0
2025-09-28 12:07:41.400 +03:00 [INF] Starting database seeding.
2025-09-28 12:07:41.856 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 12:07:44.185 +03:00 [INF] Executed DbCommand (101ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 12:07:44.345 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 12:07:44.352 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 12:07:44.372 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 12:07:44.426 +03:00 [INF] Database seeding finished successfully.
2025-09-28 12:07:45.105 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 12:07:45.108 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 12:07:45.267 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 12:07:45.270 +03:00 [INF] Hosting environment: Development
2025-09-28 12:07:45.273 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 12:07:45.579 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5132/api/Persons/5 - application/json 57
2025-09-28 12:07:45.771 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5132/api/Persons/5 - 307 0 null 213.0635ms
2025-09-28 12:07:45.825 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7266/api/Persons/5 - application/json 57
2025-09-28 12:07:46.125 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:07:46.128 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:07:46.131 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:07:46.136 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:07:46.139 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:07:46.142 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:07:46.150 +03:00 [INF] Incomming Request: DELETE /api/Persons/5
2025-09-28 12:07:46.155 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API)'
2025-09-28 12:07:46.207 +03:00 [INF] Route matched with {action = "Delete", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 12:07:46.652 +03:00 [INF] Executing an action Delete on controller Persons.
2025-09-28 12:09:15.560 +03:00 [INF] Executed DbCommand (121ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[FirstName], [s].[LastName], [s].[Id0], [s].[AccessFailedCount], [s].[ConcurrencyStamp], [s].[Email], [s].[EmailConfirmed], [s].[LockoutEnabled], [s].[LockoutEnd], [s].[NormalizedEmail], [s].[NormalizedUserName], [s].[PasswordHash], [s].[PersonId], [s].[PhoneNumber], [s].[PhoneNumberConfirmed], [s].[RefreshToken], [s].[RefreshTokenExpiryTime], [s].[SecurityStamp], [s].[TwoFactorEnabled], [s].[UserName], [s].[Id1], [s].[PersonId0], [s].[Id2], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate], [s].[Biography], [s].[PersonId1]
FROM (
    SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id] AS [Id1], [b].[PersonId] AS [PersonId0], [a0].[Id] AS [Id2], [a0].[Biography], [a0].[PersonId] AS [PersonId1]
    FROM [Persons] AS [p]
    LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
    LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
    LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
    WHERE [p].[Id] = @__id_0
) AS [s]
LEFT JOIN [Borrowings] AS [b0] ON [s].[Id1] = [b0].[BorrowerId]
ORDER BY [s].[Id], [s].[Id0], [s].[Id1], [s].[Id2]
2025-09-28 12:10:02.239 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API) in 136009.8731ms
2025-09-28 12:10:02.261 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.Delete (LibraryManagementSystem.API)'
2025-09-28 12:10:07.431 +03:00 [ERR] An unhandled exception has occurred while executing the request.
LibraryManagementSystem.Business.Exceptions.ConflictException: Can not delete person with active loans.
   at LibraryManagementSystem.Business.Services.PersonService.DeletePersonAsync(Int32 id) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\PersonService.cs:line 114
   at LibraryManagementSystem.API.Controllers.PersonsController.Delete(Int32 id) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\PersonsController.cs:line 173
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:10:07.606 +03:00 [WRN] An Conflict exception has occured: Can not delete person with active loans.
LibraryManagementSystem.Business.Exceptions.ConflictException: Can not delete person with active loans.
   at LibraryManagementSystem.Business.Services.PersonService.DeletePersonAsync(Int32 id) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\PersonService.cs:line 114
   at LibraryManagementSystem.API.Controllers.PersonsController.Delete(Int32 id) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\PersonsController.cs:line 173
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:10:07.923 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7266/api/Persons/5 - 409 null application/problem+json 142098.0946ms
2025-09-28 12:14:42.074 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 12:14:42.121 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 47.0344ms
2025-09-28 12:14:42.131 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 12:14:42.209 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/28/2025 9:02:47 AM', Current time (UTC): '9/28/2025 9:14:42 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 12:14:42.287 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/28/2025 9:02:47 AM', Current time (UTC): '9/28/2025 9:14:42 AM'.
2025-09-28 12:14:42.306 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 12:14:42.344 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 12:14:42.356 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 401 0 null 225.0535ms
2025-09-28 12:16:20.447 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - application/json 505
2025-09-28 12:16:20.490 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - 307 0 null 43.7488ms
2025-09-28 12:16:20.497 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Token/Refresh - application/json 505
2025-09-28 12:16:20.544 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:16:20.550 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:16:20.562 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:16:20.570 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:16:20.580 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:16:20.593 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:16:20.602 +03:00 [INF] Incomming Request: POST /api/Token/Refresh
2025-09-28 12:16:20.615 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API)'
2025-09-28 12:16:20.664 +03:00 [INF] Route matched with {action = "Refresh", controller = "Token"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Refresh(LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto) on controller LibraryManagementSystem.API.Controllers.TokenController (LibraryManagementSystem.API).
2025-09-28 12:16:20.851 +03:00 [INF] Executing an action Refresh on controller Token.
2025-09-28 12:16:21.134 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-09-28 12:16:21.279 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-09-28 12:16:21.436 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-09-28 12:16:21.491 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 12:16:22.060 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p17='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p18='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 256), @p7='?' (Size = 256), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [LockoutEnabled] = @p4, [LockoutEnd] = @p5, [NormalizedEmail] = @p6, [NormalizedUserName] = @p7, [PasswordHash] = @p8, [PersonId] = @p9, [PhoneNumber] = @p10, [PhoneNumberConfirmed] = @p11, [RefreshToken] = @p12, [RefreshTokenExpiryTime] = @p13, [SecurityStamp] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-09-28 12:16:22.162 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto'.
2025-09-28 12:16:22.182 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API) in 1494.5818ms
2025-09-28 12:16:22.195 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API)'
2025-09-28 12:16:22.207 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 12:16:22.223 +03:00 [INF] Generating expiration headers.
2025-09-28 12:16:22.234 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 09:17:22 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 12:16:22.249 +03:00 [INF] Generating Validation headers.
2025-09-28 12:16:22.296 +03:00 [INF] Validation headers generated. ETag: Strong, "10D9426EBD58A1C3B9A18AB4BFA14A8D". Last-Modified: Sun, 28 Sep 2025 09:16:22 GMT
2025-09-28 12:16:22.306 +03:00 [INF] Generating Vary header.
2025-09-28 12:16:22.312 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 12:16:22.336 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Token/Refresh - 200 null application/json; charset=utf-8 1839.5401ms
2025-09-28 12:16:47.122 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 12:16:47.139 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 21.4068ms
2025-09-28 12:16:47.146 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 12:16:47.177 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:16:47.180 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:16:47.184 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:16:47.186 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:16:47.189 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:16:47.193 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:16:47.195 +03:00 [INF] Incomming Request: POST /api/Books/Collection
2025-09-28 12:16:47.199 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:16:47.207 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.BookDtos.CreateBookDto]) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 12:16:47.270 +03:00 [INF] Executing an action CreateCollection on controller Books.
2025-09-28 12:16:47.484 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__isbns_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[ISBN]
FROM [Books] AS [b]
WHERE [b].[ISBN] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__isbns_0) WITH ([value] nvarchar(13) '$') AS [i]
)
2025-09-28 12:18:34.925 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API) in 107707.6885ms
2025-09-28 12:18:34.950 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Books/isbn/9780132350884 - null null
2025-09-28 12:18:34.971 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:18:34.997 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Books/isbn/9780132350884 - 307 0 null 47.3475ms
2025-09-28 12:18:35.754 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Books/isbn/9780132350884 - null null
2025-09-28 12:18:40.260 +03:00 [ERR] An unhandled exception has occurred while executing the request.
LibraryManagementSystem.Business.Exceptions.ConflictException: The following Books Isbns are Already Exist: 9780132350884.
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 109
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:18:40.308 +03:00 [INF] No cached response available for this request.
2025-09-28 12:18:40.475 +03:00 [WRN] An Conflict exception has occured: The following Books Isbns are Already Exist: 9780132350884.
LibraryManagementSystem.Business.Exceptions.ConflictException: The following Books Isbns are Already Exist: 9780132350884.
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 109
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:18:40.484 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:18:40.634 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 12:18:40.640 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 499 null application/problem+json 113495.3525ms
2025-09-28 12:18:40.640 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:18:40.675 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:18:40.683 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:18:40.692 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:18:40.700 +03:00 [INF] Incomming Request: GET /api/Books/isbn/9780132350884
2025-09-28 12:18:40.714 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.GetByIsbn (LibraryManagementSystem.API)'
2025-09-28 12:18:40.742 +03:00 [INF] Route matched with {action = "GetByIsbn", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByIsbn(System.String) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 12:18:40.768 +03:00 [INF] Executing an action GetByIsbn on controller Books.
2025-09-28 12:18:40.902 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__isbn_0='?' (Size = 13)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [s].[Id], [s].[Biography], [s].[PersonId], [s].[Id0], [s].[FirstName], [s].[LastName], [s].[AuthorsId], [s].[BooksId]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[ISBN] = @__isbn_0
) AS [b1]
LEFT JOIN (
    SELECT [a].[Id], [a].[Biography], [a].[PersonId], [p].[Id] AS [Id0], [p].[FirstName], [p].[LastName], [b0].[AuthorsId], [b0].[BooksId]
    FROM [BookAuthors] AS [b0]
    INNER JOIN [Authors] AS [a] ON [b0].[AuthorsId] = [a].[Id]
    INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
) AS [s] ON [b1].[Id] = [s].[BooksId]
ORDER BY [b1].[Id], [s].[AuthorsId], [s].[BooksId], [s].[Id]
2025-09-28 12:18:40.983 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.BookDtos.BookDetailsDto'.
2025-09-28 12:18:41.002 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.GetByIsbn (LibraryManagementSystem.API) in 241.7492ms
2025-09-28 12:18:41.012 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.GetByIsbn (LibraryManagementSystem.API)'
2025-09-28 12:18:41.023 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 12:18:41.031 +03:00 [INF] Generating expiration headers.
2025-09-28 12:18:41.039 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 09:19:41 GMT. Cache-Control: public,max-age=60.
2025-09-28 12:18:41.046 +03:00 [INF] Generating Validation headers.
2025-09-28 12:18:41.055 +03:00 [INF] Validation headers generated. ETag: Strong, "8E93B251A9AFD304978EED2B0375C5A3". Last-Modified: Sun, 28 Sep 2025 09:18:41 GMT
2025-09-28 12:18:41.066 +03:00 [INF] Generating Vary header.
2025-09-28 12:18:41.075 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 12:18:41.096 +03:00 [INF] The response has been cached.
2025-09-28 12:18:41.103 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Books/isbn/9780132350884 - 200 null application/json; charset=utf-8 5348.5267ms
2025-09-28 12:19:26.010 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 12:19:26.033 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 23.6982ms
2025-09-28 12:19:26.036 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 12:19:26.063 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:19:26.067 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:19:26.073 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:19:26.080 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:19:26.084 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:19:26.089 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:19:26.095 +03:00 [INF] Incomming Request: POST /api/Books/Collection
2025-09-28 12:19:26.101 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:19:26.110 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.BookDtos.CreateBookDto]) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 12:19:26.153 +03:00 [INF] Executing an action CreateCollection on controller Books.
2025-09-28 12:19:26.165 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__isbns_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[ISBN]
FROM [Books] AS [b]
WHERE [b].[ISBN] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__isbns_0) WITH ([value] nvarchar(13) '$') AS [i]
)
2025-09-28 12:19:26.258 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Biography], [a].[PersonId], [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Authors] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
WHERE [a].[Id] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-09-28 12:19:47.303 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API) in 21177.6055ms
2025-09-28 12:19:47.318 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:19:50.250 +03:00 [ERR] An unhandled exception has occurred while executing the request.
LibraryManagementSystem.Business.Exceptions.NotFoundException: The following author Ids Are not Found: System.Linq.Enumerable+<ExceptIterator>d__117`1[System.Int32]
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 120
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:19:50.322 +03:00 [WRN] A Not Found exception has occured: The following author Ids Are not Found: System.Linq.Enumerable+<ExceptIterator>d__117`1[System.Int32]
LibraryManagementSystem.Business.Exceptions.NotFoundException: The following author Ids Are not Found: System.Linq.Enumerable+<ExceptIterator>d__117`1[System.Int32]
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 120
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:19:50.372 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 404 null application/problem+json 24335.7345ms
2025-09-28 12:20:09.782 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 12:20:09.803 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 20.7732ms
2025-09-28 12:20:09.810 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 12:20:09.873 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:20:09.889 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:20:09.898 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:20:09.906 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:20:09.919 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:20:09.932 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:20:09.947 +03:00 [INF] Incomming Request: POST /api/Books/Collection
2025-09-28 12:20:09.961 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:20:09.975 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.BookDtos.CreateBookDto]) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 12:20:10.011 +03:00 [INF] Executing an action CreateCollection on controller Books.
2025-09-28 12:20:10.026 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__isbns_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[ISBN]
FROM [Books] AS [b]
WHERE [b].[ISBN] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__isbns_0) WITH ([value] nvarchar(13) '$') AS [i]
)
2025-09-28 12:20:10.066 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Biography], [a].[PersonId], [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Authors] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
WHERE [a].[Id] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-09-28 12:20:29.361 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API) in 19352.7052ms
2025-09-28 12:20:29.383 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:20:32.886 +03:00 [ERR] An unhandled exception has occurred while executing the request.
LibraryManagementSystem.Business.Exceptions.NotFoundException: The following author Ids Are not Found: System.Linq.Enumerable+<ExceptIterator>d__117`1[System.Int32]
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 120
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:20:33.003 +03:00 [WRN] A Not Found exception has occured: The following author Ids Are not Found: System.Linq.Enumerable+<ExceptIterator>d__117`1[System.Int32]
LibraryManagementSystem.Business.Exceptions.NotFoundException: The following author Ids Are not Found: System.Linq.Enumerable+<ExceptIterator>d__117`1[System.Int32]
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 120
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:20:33.058 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 404 null application/problem+json 23247.5822ms
2025-09-28 12:20:45.333 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 12:20:45.349 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 16.1802ms
2025-09-28 12:20:45.355 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 12:20:45.379 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:20:45.381 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:20:45.383 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:20:45.386 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:20:45.389 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:20:45.392 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:20:45.394 +03:00 [INF] Incomming Request: POST /api/Books/Collection
2025-09-28 12:20:45.398 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:20:45.402 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.BookDtos.CreateBookDto]) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 12:20:45.412 +03:00 [INF] Executing an action CreateCollection on controller Books.
2025-09-28 12:20:45.421 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__isbns_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[ISBN]
FROM [Books] AS [b]
WHERE [b].[ISBN] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__isbns_0) WITH ([value] nvarchar(13) '$') AS [i]
)
2025-09-28 12:20:45.438 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Biography], [a].[PersonId], [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Authors] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
WHERE [a].[Id] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-09-28 12:20:45.800 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 13), @p2='?' (DbType = Int32), @p3='?' (Size = 100), @p4='?' (DbType = DateTime2), @p5='?' (Size = 13), @p6='?' (DbType = Int32), @p7='?' (Size = 100), @p8='?' (DbType = DateTime2), @p9='?' (Size = 13), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = Int32), @p13='?' (Size = 100), @p14='?' (Size = 100), @p15='?' (DbType = Int32), @p16='?' (Size = 100), @p17='?' (Size = 100), @p18='?' (DbType = Int32), @p19='?' (Size = 1000), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (Size = 1000), @p23='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Books] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1),
(@p8, @p9, @p10, @p11, 2)) AS i ([DeleteDate], [ISBN], [PublishYear], [Title], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([DeleteDate], [ISBN], [PublishYear], [Title])
VALUES (i.[DeleteDate], i.[ISBN], i.[PublishYear], i.[Title])
OUTPUT INSERTED.[Id], i._Position;
INSERT INTO [Persons] ([Id], [FirstName], [LastName])
VALUES (@p12, @p13, @p14),
(@p15, @p16, @p17);
INSERT INTO [Authors] ([Id], [Biography], [PersonId])
VALUES (@p18, @p19, @p20),
(@p21, @p22, @p23);
2025-09-28 12:20:45.927 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'LibraryManagementSystem.DataAccess.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-28 12:21:51.812 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API) in 66401.5437ms
2025-09-28 12:21:51.834 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:21:57.978 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.UnitOfWork.UnitOfWork.CompleteAsync() in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\UnitOfWork\UnitOfWork.cs:line 44
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 138
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:21:58.345 +03:00 [ERR] An unhandled exception occurred: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.UnitOfWork.UnitOfWork.CompleteAsync() in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\UnitOfWork\UnitOfWork.cs:line 44
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 138
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:21:58.621 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 500 null application/problem+json 73267.3805ms
2025-09-28 12:23:43.543 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 12:23:43.560 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 17.2409ms
2025-09-28 12:23:43.563 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 12:23:43.579 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:23:43.582 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:23:43.585 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:23:43.586 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:23:43.589 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:23:43.592 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:23:43.595 +03:00 [INF] Incomming Request: POST /api/Books/Collection
2025-09-28 12:23:43.600 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:23:43.605 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.BookDtos.CreateBookDto]) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 12:23:43.611 +03:00 [INF] Executing an action CreateCollection on controller Books.
2025-09-28 12:23:43.617 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__isbns_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[ISBN]
FROM [Books] AS [b]
WHERE [b].[ISBN] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__isbns_0) WITH ([value] nvarchar(13) '$') AS [i]
)
2025-09-28 12:23:43.628 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Biography], [a].[PersonId], [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Authors] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
WHERE [a].[Id] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-09-28 12:23:43.643 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 13), @p2='?' (DbType = Int32), @p3='?' (Size = 100), @p4='?' (DbType = DateTime2), @p5='?' (Size = 13), @p6='?' (DbType = Int32), @p7='?' (Size = 100), @p8='?' (DbType = DateTime2), @p9='?' (Size = 13), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = Int32), @p13='?' (Size = 100), @p14='?' (Size = 100), @p15='?' (DbType = Int32), @p16='?' (Size = 100), @p17='?' (Size = 100), @p18='?' (DbType = Int32), @p19='?' (Size = 1000), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (Size = 1000), @p23='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Books] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1),
(@p8, @p9, @p10, @p11, 2)) AS i ([DeleteDate], [ISBN], [PublishYear], [Title], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([DeleteDate], [ISBN], [PublishYear], [Title])
VALUES (i.[DeleteDate], i.[ISBN], i.[PublishYear], i.[Title])
OUTPUT INSERTED.[Id], i._Position;
INSERT INTO [Persons] ([Id], [FirstName], [LastName])
VALUES (@p12, @p13, @p14),
(@p15, @p16, @p17);
INSERT INTO [Authors] ([Id], [Biography], [PersonId])
VALUES (@p18, @p19, @p20),
(@p21, @p22, @p23);
2025-09-28 12:23:43.669 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'LibraryManagementSystem.DataAccess.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-28 12:26:42.365 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API) in 178754.359ms
2025-09-28 12:26:42.379 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 12:26:42.394 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:26:42.412 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 40.8212ms
2025-09-28 12:26:43.190 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 12:26:48.007 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.UnitOfWork.UnitOfWork.CompleteAsync() in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\UnitOfWork\UnitOfWork.cs:line 44
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 138
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:26:48.014 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:26:48.111 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:26:48.111 +03:00 [ERR] An unhandled exception occurred: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.UnitOfWork.UnitOfWork.CompleteAsync() in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\UnitOfWork\UnitOfWork.cs:line 44
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 138
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:26:48.113 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:26:48.207 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:26:48.208 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 499 null application/problem+json 184644.862ms
2025-09-28 12:26:48.208 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:26:48.217 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:26:48.221 +03:00 [INF] Incomming Request: POST /api/Books/Collection
2025-09-28 12:26:48.224 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:26:48.228 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.BookDtos.CreateBookDto]) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 12:26:48.237 +03:00 [INF] Executing an action CreateCollection on controller Books.
2025-09-28 12:26:48.243 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__isbns_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[ISBN]
FROM [Books] AS [b]
WHERE [b].[ISBN] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__isbns_0) WITH ([value] nvarchar(13) '$') AS [i]
)
2025-09-28 12:26:48.254 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Biography], [a].[PersonId], [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Authors] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
WHERE [a].[Id] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-09-28 12:26:49.211 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 13), @p2='?' (DbType = Int32), @p3='?' (Size = 100), @p4='?' (DbType = DateTime2), @p5='?' (Size = 13), @p6='?' (DbType = Int32), @p7='?' (Size = 100), @p8='?' (DbType = DateTime2), @p9='?' (Size = 13), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = Int32), @p13='?' (Size = 100), @p14='?' (Size = 100), @p15='?' (DbType = Int32), @p16='?' (Size = 100), @p17='?' (Size = 100), @p18='?' (DbType = Int32), @p19='?' (Size = 1000), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (Size = 1000), @p23='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Books] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1),
(@p8, @p9, @p10, @p11, 2)) AS i ([DeleteDate], [ISBN], [PublishYear], [Title], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([DeleteDate], [ISBN], [PublishYear], [Title])
VALUES (i.[DeleteDate], i.[ISBN], i.[PublishYear], i.[Title])
OUTPUT INSERTED.[Id], i._Position;
INSERT INTO [Persons] ([Id], [FirstName], [LastName])
VALUES (@p12, @p13, @p14),
(@p15, @p16, @p17);
INSERT INTO [Authors] ([Id], [Biography], [PersonId])
VALUES (@p18, @p19, @p20),
(@p21, @p22, @p23);
2025-09-28 12:26:49.283 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'LibraryManagementSystem.DataAccess.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-28 12:26:51.995 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API) in 3758.5841ms
2025-09-28 12:26:52.010 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:26:57.538 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.UnitOfWork.UnitOfWork.CompleteAsync() in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\UnitOfWork\UnitOfWork.cs:line 44
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 138
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:26:57.876 +03:00 [ERR] An unhandled exception occurred: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.UnitOfWork.UnitOfWork.CompleteAsync() in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\UnitOfWork\UnitOfWork.cs:line 44
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 138
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:26:58.161 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 500 null application/problem+json 14970.8723ms
2025-09-28 12:27:03.909 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 12:27:03.929 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 20.1271ms
2025-09-28 12:27:03.934 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 12:27:03.980 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:27:03.990 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:27:03.998 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:27:04.007 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:27:04.015 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:27:04.025 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:27:04.035 +03:00 [INF] Incomming Request: POST /api/Books/Collection
2025-09-28 12:27:04.049 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:27:04.065 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.BookDtos.CreateBookDto]) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 12:27:04.109 +03:00 [INF] Executing an action CreateCollection on controller Books.
2025-09-28 12:27:04.130 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__isbns_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[ISBN]
FROM [Books] AS [b]
WHERE [b].[ISBN] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__isbns_0) WITH ([value] nvarchar(13) '$') AS [i]
)
2025-09-28 12:27:04.176 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Biography], [a].[PersonId], [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Authors] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
WHERE [a].[Id] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-09-28 12:28:06.440 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 13), @p2='?' (DbType = Int32), @p3='?' (Size = 100), @p4='?' (DbType = DateTime2), @p5='?' (Size = 13), @p6='?' (DbType = Int32), @p7='?' (Size = 100), @p8='?' (DbType = DateTime2), @p9='?' (Size = 13), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = Int32), @p13='?' (Size = 100), @p14='?' (Size = 100), @p15='?' (DbType = Int32), @p16='?' (Size = 100), @p17='?' (Size = 100), @p18='?' (DbType = Int32), @p19='?' (Size = 1000), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (Size = 1000), @p23='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Books] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1),
(@p8, @p9, @p10, @p11, 2)) AS i ([DeleteDate], [ISBN], [PublishYear], [Title], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([DeleteDate], [ISBN], [PublishYear], [Title])
VALUES (i.[DeleteDate], i.[ISBN], i.[PublishYear], i.[Title])
OUTPUT INSERTED.[Id], i._Position;
INSERT INTO [Persons] ([Id], [FirstName], [LastName])
VALUES (@p12, @p13, @p14),
(@p15, @p16, @p17);
INSERT INTO [Authors] ([Id], [Biography], [PersonId])
VALUES (@p18, @p19, @p20),
(@p21, @p22, @p23);
2025-09-28 12:28:06.581 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'LibraryManagementSystem.DataAccess.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-28 12:28:17.009 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API) in 72902.0603ms
2025-09-28 12:28:17.014 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:28:22.599 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.UnitOfWork.UnitOfWork.CompleteAsync() in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\UnitOfWork\UnitOfWork.cs:line 44
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 138
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:28:30.534 +03:00 [ERR] An unhandled exception occurred: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.UnitOfWork.UnitOfWork.CompleteAsync() in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\UnitOfWork\UnitOfWork.cs:line 44
   at LibraryManagementSystem.Business.Services.BookService.CreateBooksCollectionAsync(IEnumerable`1 newBookDtos) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 138
   at LibraryManagementSystem.API.Controllers.BooksController.CreateCollection(CreateCollectionDto`1 createCollectionDto) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 197
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 12:28:30.914 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 500 null application/problem+json 86979.9831ms
2025-09-28 12:31:55.286 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 12:31:55.309 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 23.7262ms
2025-09-28 12:31:55.312 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 12:31:55.333 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 12:31:55.335 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 12:31:55.337 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 12:31:55.340 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 12:31:55.342 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 12:31:55.345 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 12:31:55.347 +03:00 [INF] Incomming Request: POST /api/Books/Collection
2025-09-28 12:31:55.350 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 12:31:55.353 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.BookDtos.CreateBookDto]) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 12:31:55.360 +03:00 [INF] Executing an action CreateCollection on controller Books.
2025-09-28 12:31:55.365 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__isbns_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[ISBN]
FROM [Books] AS [b]
WHERE [b].[ISBN] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__isbns_0) WITH ([value] nvarchar(13) '$') AS [i]
)
2025-09-28 12:31:55.377 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Biography], [a].[PersonId], [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Authors] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
WHERE [a].[Id] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-09-28 12:37:57.538 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 13), @p2='?' (DbType = Int32), @p3='?' (Size = 100), @p4='?' (DbType = DateTime2), @p5='?' (Size = 13), @p6='?' (DbType = Int32), @p7='?' (Size = 100), @p8='?' (DbType = DateTime2), @p9='?' (Size = 13), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = Int32), @p13='?' (Size = 100), @p14='?' (Size = 100), @p15='?' (DbType = Int32), @p16='?' (Size = 100), @p17='?' (Size = 100), @p18='?' (DbType = Int32), @p19='?' (Size = 1000), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (Size = 1000), @p23='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Books] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1),
(@p8, @p9, @p10, @p11, 2)) AS i ([DeleteDate], [ISBN], [PublishYear], [Title], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([DeleteDate], [ISBN], [PublishYear], [Title])
VALUES (i.[DeleteDate], i.[ISBN], i.[PublishYear], i.[Title])
OUTPUT INSERTED.[Id], i._Position;
INSERT INTO [Persons] ([Id], [FirstName], [LastName])
VALUES (@p12, @p13, @p14),
(@p15, @p16, @p17);
INSERT INTO [Authors] ([Id], [Biography], [PersonId])
VALUES (@p18, @p19, @p20),
(@p21, @p22, @p23);
2025-09-28 12:37:57.668 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'LibraryManagementSystem.DataAccess.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Persons' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e672c596-5da2-4ede-9570-ee641513ee4e
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-28 13:40:00.659 +03:00 [INF] Starting database seeding.
2025-09-28 13:40:01.316 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 13:40:05.046 +03:00 [INF] Executed DbCommand (222ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 13:40:05.335 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 13:40:05.345 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 13:40:05.397 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 13:40:05.540 +03:00 [INF] Database seeding finished successfully.
2025-09-28 13:40:06.659 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 13:40:06.662 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 13:40:07.080 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 13:40:07.083 +03:00 [INF] Hosting environment: Development
2025-09-28 13:40:07.087 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 13:40:07.859 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 13:40:08.057 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 215.9106ms
2025-09-28 13:40:08.178 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 13:40:08.533 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/28/2025 10:16:21 AM', Current time (UTC): '9/28/2025 10:40:08 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 13:40:08.601 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/28/2025 10:16:21 AM', Current time (UTC): '9/28/2025 10:40:08 AM'.
2025-09-28 13:40:08.633 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-28 13:40:08.667 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 13:40:08.682 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 401 0 null 504.6526ms
2025-09-28 13:40:46.471 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - application/json 505
2025-09-28 13:40:46.483 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - 307 0 null 12.7205ms
2025-09-28 13:40:46.501 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Token/Refresh - application/json 505
2025-09-28 13:40:46.553 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 13:40:46.558 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 13:40:46.565 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 13:40:46.579 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 13:40:46.585 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 13:40:46.590 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 13:40:46.606 +03:00 [INF] Incomming Request: POST /api/Token/Refresh
2025-09-28 13:40:46.613 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API)'
2025-09-28 13:40:46.692 +03:00 [INF] Route matched with {action = "Refresh", controller = "Token"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Refresh(LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto) on controller LibraryManagementSystem.API.Controllers.TokenController (LibraryManagementSystem.API).
2025-09-28 13:40:47.338 +03:00 [INF] Executing an action Refresh on controller Token.
2025-09-28 13:40:47.651 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-09-28 13:40:47.809 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-09-28 13:40:48.001 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-09-28 13:40:48.082 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 13:40:48.669 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p17='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p18='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 256), @p7='?' (Size = 256), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [LockoutEnabled] = @p4, [LockoutEnd] = @p5, [NormalizedEmail] = @p6, [NormalizedUserName] = @p7, [PasswordHash] = @p8, [PersonId] = @p9, [PhoneNumber] = @p10, [PhoneNumberConfirmed] = @p11, [RefreshToken] = @p12, [RefreshTokenExpiryTime] = @p13, [SecurityStamp] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-09-28 13:40:48.736 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto'.
2025-09-28 13:40:48.760 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API) in 2040.8608ms
2025-09-28 13:40:48.772 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API)'
2025-09-28 13:40:48.780 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 13:40:48.795 +03:00 [INF] Generating expiration headers.
2025-09-28 13:40:48.807 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 10:41:48 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 13:40:48.826 +03:00 [INF] Generating Validation headers.
2025-09-28 13:40:48.879 +03:00 [INF] Validation headers generated. ETag: Strong, "034D72D692D1A73F3F153E492454E4F8". Last-Modified: Sun, 28 Sep 2025 10:40:48 GMT
2025-09-28 13:40:48.892 +03:00 [INF] Generating Vary header.
2025-09-28 13:40:48.901 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 13:40:48.956 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Token/Refresh - 200 null application/json; charset=utf-8 2455.0217ms
2025-09-28 13:41:27.579 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/Collection - application/json 514
2025-09-28 13:41:27.600 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/Collection - 307 0 null 22.9809ms
2025-09-28 13:41:27.606 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/Collection - application/json 514
2025-09-28 13:41:27.660 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 13:41:27.664 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 13:41:27.670 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 13:41:27.675 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 13:41:27.684 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 13:41:27.692 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 13:41:27.699 +03:00 [INF] Incomming Request: POST /api/Books/Collection
2025-09-28 13:41:27.713 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 13:41:27.730 +03:00 [INF] Route matched with {action = "CreateCollection", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCollection(LibraryManagementSystem.Business.Dtos.Shared.CreateCollectionDto`1[LibraryManagementSystem.Business.Dtos.BookDtos.CreateBookDto]) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 13:41:27.809 +03:00 [INF] Executing an action CreateCollection on controller Books.
2025-09-28 13:41:27.987 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__isbns_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[ISBN]
FROM [Books] AS [b]
WHERE [b].[ISBN] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__isbns_0) WITH ([value] nvarchar(13) '$') AS [i]
)
2025-09-28 13:41:28.108 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Biography], [a].[PersonId], [p].[Id], [p].[FirstName], [p].[LastName]
FROM [Authors] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
WHERE [a].[Id] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-09-28 13:41:28.458 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 13), @p2='?' (DbType = Int32), @p3='?' (Size = 100), @p4='?' (DbType = DateTime2), @p5='?' (Size = 13), @p6='?' (DbType = Int32), @p7='?' (Size = 100), @p8='?' (DbType = DateTime2), @p9='?' (Size = 13), @p10='?' (DbType = Int32), @p11='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Books] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1),
(@p8, @p9, @p10, @p11, 2)) AS i ([DeleteDate], [ISBN], [PublishYear], [Title], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([DeleteDate], [ISBN], [PublishYear], [Title])
VALUES (i.[DeleteDate], i.[ISBN], i.[PublishYear], i.[Title])
OUTPUT INSERTED.[Id], i._Position;
2025-09-28 13:41:28.532 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?' (DbType = Int32), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BookAuthors] ([AuthorsId], [BooksId])
VALUES (@p12, @p13),
(@p14, @p15),
(@p16, @p17),
(@p18, @p19);
2025-09-28 13:41:28.601 +03:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[LibraryManagementSystem.Business.Dtos.BookDtos.BookDetailsDto, LibraryManagementSystem.Business, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-28 13:41:28.620 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API) in 860.9683ms
2025-09-28 13:41:28.635 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.CreateCollection (LibraryManagementSystem.API)'
2025-09-28 13:41:28.647 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 13:41:28.652 +03:00 [INF] Generating expiration headers.
2025-09-28 13:41:28.658 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 10:42:28 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 13:41:28.666 +03:00 [INF] Generating Validation headers.
2025-09-28 13:41:28.673 +03:00 [INF] Validation headers generated. ETag: Strong, "6919F02A81F71692B6A0054233B9BFDE". Last-Modified: Sun, 28 Sep 2025 10:41:28 GMT
2025-09-28 13:41:28.679 +03:00 [INF] Generating Vary header.
2025-09-28 13:41:28.684 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 13:41:28.692 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/Collection - 201 null application/json; charset=utf-8 1086.5798ms
2025-09-28 13:43:47.701 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/1/Borrow - application/json 514
2025-09-28 13:43:47.769 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/1/Borrow - 307 0 null 68.1623ms
2025-09-28 13:43:47.773 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/1/Borrow - application/json 514
2025-09-28 13:43:47.828 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 13:43:47.834 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 13:43:47.844 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 13:43:47.856 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 13:43:47.864 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 13:43:47.875 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 13:43:47.888 +03:00 [INF] Incomming Request: POST /api/Books/1/Borrow
2025-09-28 13:43:47.902 +03:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2025-09-28 13:43:47.917 +03:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2025-09-28 13:43:47.933 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 13:43:47.946 +03:00 [INF] Generating expiration headers.
2025-09-28 13:43:47.962 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 10:44:47 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 13:43:47.984 +03:00 [INF] Not generating Validation headers as the response status code does not indicate success.
2025-09-28 13:43:47.991 +03:00 [INF] Generating Vary header.
2025-09-28 13:43:48.003 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 13:43:48.107 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/1/Borrow - 405 null application/problem+json 334.1888ms
2025-09-28 13:43:57.442 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - application/json 514
2025-09-28 13:43:57.453 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - 307 0 null 11.1788ms
2025-09-28 13:43:57.455 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - application/json 514
2025-09-28 13:43:57.487 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Borrower)
2025-09-28 13:43:57.508 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-28 13:43:57.517 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - 403 0 null 62.1009ms
2025-09-28 13:45:28.172 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5132/api/Persons/10 - application/json 514
2025-09-28 13:45:28.216 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5132/api/Persons/10 - 307 0 null 43.4064ms
2025-09-28 13:45:28.220 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7266/api/Persons/10 - application/json 514
2025-09-28 13:45:28.265 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 13:45:28.277 +03:00 [INF] Not valid - no If-None-Match or If-Modified-Since headers.
2025-09-28 13:45:28.282 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 13:45:28.293 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 13:45:28.302 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 13:45:28.315 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 13:45:28.327 +03:00 [INF] Incomming Request: GET /api/Persons/10
2025-09-28 13:45:28.340 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 13:45:28.382 +03:00 [INF] Route matched with {action = "GetById", controller = "Persons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller LibraryManagementSystem.API.Controllers.PersonsController (LibraryManagementSystem.API).
2025-09-28 13:45:28.428 +03:00 [INF] Executing an action GetById on controller Persons.
2025-09-28 13:45:28.701 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[FirstName], [s].[LastName], [s].[Id0], [s].[AccessFailedCount], [s].[ConcurrencyStamp], [s].[Email], [s].[EmailConfirmed], [s].[LockoutEnabled], [s].[LockoutEnd], [s].[NormalizedEmail], [s].[NormalizedUserName], [s].[PasswordHash], [s].[PersonId], [s].[PhoneNumber], [s].[PhoneNumberConfirmed], [s].[RefreshToken], [s].[RefreshTokenExpiryTime], [s].[SecurityStamp], [s].[TwoFactorEnabled], [s].[UserName], [s].[Id1], [s].[PersonId0], [s].[Id2], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate], [s].[Biography], [s].[PersonId1]
FROM (
    SELECT TOP(2) [p].[Id], [p].[FirstName], [p].[LastName], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id] AS [Id1], [b].[PersonId] AS [PersonId0], [a0].[Id] AS [Id2], [a0].[Biography], [a0].[PersonId] AS [PersonId1]
    FROM [Persons] AS [p]
    LEFT JOIN [AspNetUsers] AS [a] ON [p].[Id] = [a].[PersonId]
    LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
    LEFT JOIN [Authors] AS [a0] ON [p].[Id] = [a0].[PersonId]
    WHERE [p].[Id] = @__id_0
) AS [s]
LEFT JOIN [Borrowings] AS [b0] ON [s].[Id1] = [b0].[BorrowerId]
ORDER BY [s].[Id], [s].[Id0], [s].[Id1], [s].[Id2]
2025-09-28 13:45:28.855 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.PersonDtos.PersonDetailsDto'.
2025-09-28 13:45:28.884 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API) in 471.2386ms
2025-09-28 13:45:28.901 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.PersonsController.GetById (LibraryManagementSystem.API)'
2025-09-28 13:45:28.919 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 13:45:28.931 +03:00 [INF] Generating expiration headers.
2025-09-28 13:45:28.944 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 10:46:28 GMT. Cache-Control: public,max-age=60.
2025-09-28 13:45:28.956 +03:00 [INF] Generating Validation headers.
2025-09-28 13:45:28.966 +03:00 [INF] Validation headers generated. ETag: Strong, "57F36F888CAD7797FC161DD9F18DA17C". Last-Modified: Sun, 28 Sep 2025 10:45:28 GMT
2025-09-28 13:45:28.984 +03:00 [INF] Generating Vary header.
2025-09-28 13:45:28.992 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 13:45:29.005 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7266/api/Persons/10 - 200 null application/json; charset=utf-8 785.1136ms
2025-09-28 13:47:42.928 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Accounts/Login - application/json 85
2025-09-28 13:47:42.967 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Accounts/Login - 307 0 null 42.452ms
2025-09-28 13:47:42.979 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Accounts/Login - application/json 85
2025-09-28 13:47:43.014 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 13:47:43.022 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 13:47:43.026 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 13:47:43.032 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 13:47:43.036 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 13:47:43.040 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 13:47:43.044 +03:00 [INF] Incomming Request: POST /api/Accounts/Login
2025-09-28 13:47:43.051 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.AccountsController.Login (LibraryManagementSystem.API)'
2025-09-28 13:47:43.062 +03:00 [INF] Route matched with {action = "Login", controller = "Accounts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LibraryManagementSystem.Business.Dtos.AccountDtos.LoginDto) on controller LibraryManagementSystem.API.Controllers.AccountsController (LibraryManagementSystem.API).
2025-09-28 13:47:43.087 +03:00 [INF] Executing an action Login on controller Accounts.
2025-09-28 13:47:43.210 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-09-28 13:47:43.572 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-09-28 13:47:43.631 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-09-28 13:47:43.669 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 13:47:43.735 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p17='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p18='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 256), @p7='?' (Size = 256), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [LockoutEnabled] = @p4, [LockoutEnd] = @p5, [NormalizedEmail] = @p6, [NormalizedUserName] = @p7, [PasswordHash] = @p8, [PersonId] = @p9, [PhoneNumber] = @p10, [PhoneNumberConfirmed] = @p11, [RefreshToken] = @p12, [RefreshTokenExpiryTime] = @p13, [SecurityStamp] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-09-28 13:47:43.774 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto'.
2025-09-28 13:47:43.798 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.AccountsController.Login (LibraryManagementSystem.API) in 719.1307ms
2025-09-28 13:47:43.809 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.AccountsController.Login (LibraryManagementSystem.API)'
2025-09-28 13:47:43.856 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 13:47:43.862 +03:00 [INF] Generating expiration headers.
2025-09-28 13:47:43.871 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 10:48:43 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 13:47:43.877 +03:00 [INF] Generating Validation headers.
2025-09-28 13:47:43.883 +03:00 [INF] Validation headers generated. ETag: Strong, "A9308FAABB6B959AFDFFC91B8869D39C". Last-Modified: Sun, 28 Sep 2025 10:47:43 GMT
2025-09-28 13:47:43.890 +03:00 [INF] Generating Vary header.
2025-09-28 13:47:43.896 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 13:47:43.904 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Accounts/Login - 200 null application/json; charset=utf-8 924.4931ms
2025-09-28 13:50:19.303 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - null 0
2025-09-28 13:50:19.318 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - 307 0 null 14.535ms
2025-09-28 13:50:19.320 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - null 0
2025-09-28 13:50:19.347 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 13:50:19.394 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 13:50:19.397 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 13:50:19.400 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 13:50:19.403 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 13:50:19.406 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 13:50:19.409 +03:00 [INF] Incomming Request: PUT /api/Books/1/Borrow
2025-09-28 13:50:19.413 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 13:50:19.428 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 13:50:19.439 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 13:50:19.448 +03:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-28 13:50:19.465 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 27.3689ms
2025-09-28 13:50:19.471 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 13:50:19.479 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 13:50:19.484 +03:00 [INF] Generating expiration headers.
2025-09-28 13:50:19.489 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 10:51:19 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 13:50:19.501 +03:00 [INF] Not generating Validation headers as the response status code does not indicate success.
2025-09-28 13:50:19.507 +03:00 [INF] Generating Vary header.
2025-09-28 13:50:19.514 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 13:50:19.519 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - 401 null application/problem+json; charset=utf-8 198.4204ms
2025-09-28 13:52:21.448 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - null 0
2025-09-28 13:52:21.465 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - 307 0 null 17.1134ms
2025-09-28 13:52:21.468 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - null 0
2025-09-28 13:52:21.500 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 13:52:21.512 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 13:52:21.528 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 13:52:21.533 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 13:52:21.539 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 13:52:21.547 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 13:52:21.553 +03:00 [INF] Incomming Request: PUT /api/Books/1/Borrow
2025-09-28 13:52:21.559 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 13:52:21.567 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 13:52:21.596 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 13:52:21.601 +03:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-28 13:52:21.613 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 30.9166ms
2025-09-28 13:52:21.627 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 13:52:21.640 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 13:52:21.647 +03:00 [INF] Generating expiration headers.
2025-09-28 13:52:21.656 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 10:53:21 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 13:52:21.673 +03:00 [INF] Not generating Validation headers as the response status code does not indicate success.
2025-09-28 13:52:21.687 +03:00 [INF] Generating Vary header.
2025-09-28 13:52:21.700 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 13:52:21.710 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - 401 null application/problem+json; charset=utf-8 242.1597ms
2025-09-28 13:52:49.981 +03:00 [INF] Starting database seeding.
2025-09-28 13:52:50.537 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 13:52:53.167 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 13:52:53.316 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 13:52:53.335 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 13:52:53.398 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 13:52:53.555 +03:00 [INF] Database seeding finished successfully.
2025-09-28 13:52:54.537 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 13:52:54.541 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 13:52:54.815 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 13:52:54.820 +03:00 [INF] Hosting environment: Development
2025-09-28 13:52:54.828 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 13:52:58.058 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - null 0
2025-09-28 13:52:58.223 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - 307 0 null 188.9224ms
2025-09-28 13:52:58.326 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - null 0
2025-09-28 13:52:58.632 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 13:52:58.637 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 13:52:58.641 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 13:52:58.651 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 13:52:58.663 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 13:52:58.669 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 13:52:58.685 +03:00 [INF] Incomming Request: PUT /api/Books/1/Borrow
2025-09-28 13:52:58.693 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 13:52:58.766 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 13:52:59.288 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:06:12.322 +03:00 [INF] Starting database seeding.
2025-09-28 17:06:12.539 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 17:06:13.784 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:06:13.844 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:06:13.848 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:06:13.860 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 17:06:13.894 +03:00 [INF] Database seeding finished successfully.
2025-09-28 17:06:14.176 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 17:06:14.177 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 17:06:14.261 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 17:06:14.263 +03:00 [INF] Hosting environment: Development
2025-09-28 17:06:14.265 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 17:06:32.381 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - null 0
2025-09-28 17:06:32.449 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - 307 0 null 70.7211ms
2025-09-28 17:06:32.478 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - null 0
2025-09-28 17:06:32.573 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/28/2025 11:47:43 AM', Current time (UTC): '9/28/2025 2:06:32 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 17:06:32.591 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/28/2025 11:47:43 AM', Current time (UTC): '9/28/2025 2:06:32 PM'.
2025-09-28 17:06:32.600 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Borrower)
2025-09-28 17:06:32.612 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 17:06:32.617 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - 401 0 null 138.8034ms
2025-09-28 17:07:03.472 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - application/json 521
2025-09-28 17:07:03.479 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - 307 0 null 6.4444ms
2025-09-28 17:07:03.488 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Token/Refresh - application/json 521
2025-09-28 17:07:03.512 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:07:03.514 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:07:03.516 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:07:03.518 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:07:03.519 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 17:07:03.520 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:07:03.524 +03:00 [INF] Incomming Request: POST /api/Token/Refresh
2025-09-28 17:07:03.526 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API)'
2025-09-28 17:07:03.549 +03:00 [INF] Route matched with {action = "Refresh", controller = "Token"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Refresh(LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto) on controller LibraryManagementSystem.API.Controllers.TokenController (LibraryManagementSystem.API).
2025-09-28 17:07:03.755 +03:00 [INF] Executing an action Refresh on controller Token.
2025-09-28 17:08:36.614 +03:00 [INF] Starting database seeding.
2025-09-28 17:08:36.820 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 17:08:37.936 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:08:38.030 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:08:38.037 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:08:38.053 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 17:08:38.087 +03:00 [INF] Database seeding finished successfully.
2025-09-28 17:08:38.351 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 17:08:38.352 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 17:08:38.437 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 17:08:38.438 +03:00 [INF] Hosting environment: Development
2025-09-28 17:08:38.440 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 17:09:31.520 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - application/json 521
2025-09-28 17:09:31.571 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - 307 0 null 55.4513ms
2025-09-28 17:09:31.609 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Token/Refresh - application/json 521
2025-09-28 17:09:31.670 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:09:31.672 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:09:31.673 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:09:31.675 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:09:31.676 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 17:09:31.677 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:09:31.681 +03:00 [INF] Incomming Request: POST /api/Token/Refresh
2025-09-28 17:09:31.684 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API)'
2025-09-28 17:09:31.702 +03:00 [INF] Route matched with {action = "Refresh", controller = "Token"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Refresh(LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto) on controller LibraryManagementSystem.API.Controllers.TokenController (LibraryManagementSystem.API).
2025-09-28 17:09:31.850 +03:00 [INF] Executing an action Refresh on controller Token.
2025-09-28 17:09:31.985 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-09-28 17:09:32.030 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-09-28 17:09:32.063 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-09-28 17:09:32.076 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 17:09:32.180 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p17='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p18='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 256), @p7='?' (Size = 256), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [LockoutEnabled] = @p4, [LockoutEnd] = @p5, [NormalizedEmail] = @p6, [NormalizedUserName] = @p7, [PasswordHash] = @p8, [PersonId] = @p9, [PhoneNumber] = @p10, [PhoneNumberConfirmed] = @p11, [RefreshToken] = @p12, [RefreshTokenExpiryTime] = @p13, [SecurityStamp] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-09-28 17:09:32.205 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto'.
2025-09-28 17:09:32.214 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API) in 505.1903ms
2025-09-28 17:09:32.218 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API)'
2025-09-28 17:09:32.220 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 17:09:32.223 +03:00 [INF] Generating expiration headers.
2025-09-28 17:09:32.225 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 14:10:32 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 17:09:32.228 +03:00 [INF] Generating Validation headers.
2025-09-28 17:09:32.241 +03:00 [INF] Validation headers generated. ETag: Strong, "1FDFEEF642AD3D5725A6E852AC7A4DC4". Last-Modified: Sun, 28 Sep 2025 14:09:32 GMT
2025-09-28 17:09:32.244 +03:00 [INF] Generating Vary header.
2025-09-28 17:09:32.245 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 17:09:32.254 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Token/Refresh - 200 null application/json; charset=utf-8 645.8246ms
2025-09-28 17:09:55.117 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - null 0
2025-09-28 17:09:55.160 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - 307 0 null 42.877ms
2025-09-28 17:09:55.165 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - null 0
2025-09-28 17:09:55.199 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:09:55.202 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:09:55.204 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:09:55.205 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:09:55.208 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 17:09:55.209 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:09:55.211 +03:00 [INF] Incomming Request: PUT /api/Books/1/Borrow
2025-09-28 17:09:55.212 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:09:55.218 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 17:09:55.228 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:10:23.063 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
FROM [Books] AS [b]
WHERE [b].[Id] = @__id_0
2025-09-28 17:10:23.123 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 17:10:36.305 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 41083.533ms
2025-09-28 17:10:36.310 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:11:20.311 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<Borrowing>()
    .Any(b => b.BorrowerId == __borrowerId_0 && !(b.IsReturned) && DateTime.Now.AddDays(__p_1) < DateTime.Now)' could not be translated. Additional information: Translation of member 'IsReturned' on entity type 'Borrowing' failed. This commonly occurs when the specified member is unmapped. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, LambdaExpression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.AnyAsync[TSource](IQueryable`1 source, Expression`1 predicate, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.Repositories.RepositoryBase`1.IsExist(Expression`1 expression) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\Repositories\RepositoryBase.cs:line 61
   at LibraryManagementSystem.DataAccess.Repositories.BorrowingRepository.IsHasOverdueBooks(Int32 borrowerId, Int32 dueDays) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\Repositories\BorrowingRepository.cs:line 24
   at LibraryManagementSystem.Business.Services.BookService.BorrowBookAsync(Int32 bookId, String userId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 266
   at LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync(Int32 bookId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 334
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 17:11:20.376 +03:00 [ERR] An unhandled exception occurred: The LINQ expression 'DbSet<Borrowing>()
    .Any(b => b.BorrowerId == __borrowerId_0 && !(b.IsReturned) && DateTime.Now.AddDays(__p_1) < DateTime.Now)' could not be translated. Additional information: Translation of member 'IsReturned' on entity type 'Borrowing' failed. This commonly occurs when the specified member is unmapped. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
System.InvalidOperationException: The LINQ expression 'DbSet<Borrowing>()
    .Any(b => b.BorrowerId == __borrowerId_0 && !(b.IsReturned) && DateTime.Now.AddDays(__p_1) < DateTime.Now)' could not be translated. Additional information: Translation of member 'IsReturned' on entity type 'Borrowing' failed. This commonly occurs when the specified member is unmapped. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, LambdaExpression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.AnyAsync[TSource](IQueryable`1 source, Expression`1 predicate, CancellationToken cancellationToken)
   at LibraryManagementSystem.DataAccess.Repositories.RepositoryBase`1.IsExist(Expression`1 expression) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\Repositories\RepositoryBase.cs:line 61
   at LibraryManagementSystem.DataAccess.Repositories.BorrowingRepository.IsHasOverdueBooks(Int32 borrowerId, Int32 dueDays) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.DataAccess\Repositories\BorrowingRepository.cs:line 24
   at LibraryManagementSystem.Business.Services.BookService.BorrowBookAsync(Int32 bookId, String userId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 266
   at LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync(Int32 bookId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 334
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 17:11:20.436 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - 500 null application/problem+json 85271.3292ms
2025-09-28 17:13:49.990 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - null 0
2025-09-28 17:13:49.997 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - 307 0 null 7.0099ms
2025-09-28 17:13:49.998 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - null 0
2025-09-28 17:13:50.006 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:13:50.007 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:13:50.009 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:13:50.011 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:13:50.012 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 17:13:50.013 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:13:50.015 +03:00 [INF] Incomming Request: PUT /api/Books/1/Borrow
2025-09-28 17:13:50.016 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:13:50.018 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 17:13:50.021 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:14:25.542 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
FROM [Books] AS [b]
WHERE [b].[Id] = @__id_0
2025-09-28 17:14:50.280 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 17:16:27.774 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 17:16:27.876 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Date), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Borrowings] ([BookId], [BorrowDate], [BorrowerId], [DeleteDate], [ReturnDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-28 17:16:27.893 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-09-28 17:16:27.896 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 157875.8036ms
2025-09-28 17:16:27.898 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:16:27.900 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 17:16:27.902 +03:00 [INF] Generating expiration headers.
2025-09-28 17:16:27.903 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 14:17:27 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 17:16:27.904 +03:00 [INF] Generating Validation headers.
2025-09-28 17:16:27.906 +03:00 [INF] Validation headers generated. ETag: Strong, "3BAC8C9649222B6D52049D8CD287B3F3". Last-Modified: Sun, 28 Sep 2025 14:16:27 GMT
2025-09-28 17:16:27.908 +03:00 [INF] Generating Vary header.
2025-09-28 17:16:27.909 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 17:16:27.911 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - 200 null text/plain; charset=utf-8 157912.4019ms
2025-09-28 17:18:21.482 +03:00 [INF] Starting database seeding.
2025-09-28 17:18:21.896 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 17:18:24.155 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:18:24.292 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:18:24.297 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:18:24.330 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 17:18:24.369 +03:00 [INF] Database seeding finished successfully.
2025-09-28 17:18:25.004 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 17:18:25.043 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 17:18:25.173 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 17:18:25.175 +03:00 [INF] Hosting environment: Development
2025-09-28 17:18:25.177 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 17:18:42.678 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - null 0
2025-09-28 17:18:42.747 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/1/Borrow - 307 0 null 74.0103ms
2025-09-28 17:18:42.784 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - null 0
2025-09-28 17:18:42.904 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:18:42.906 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:18:42.908 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:18:42.911 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:18:42.915 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 17:18:42.916 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:18:42.920 +03:00 [INF] Incomming Request: PUT /api/Books/1/Borrow
2025-09-28 17:18:42.923 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:18:42.942 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 17:18:43.071 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:18:43.199 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 17:18:53.165 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 10214.8428ms
2025-09-28 17:18:53.169 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:18:55.016 +03:00 [ERR] An unhandled exception has occurred while executing the request.
LibraryManagementSystem.Business.Exceptions.ConflictException: Book With Id 1 Already loaned
   at LibraryManagementSystem.Business.Services.BookService.BorrowBookAsync(Int32 bookId, String userId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 250
   at LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync(Int32 bookId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 334
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 17:18:55.066 +03:00 [WRN] An Conflict exception has occured: Book With Id 1 Already loaned
LibraryManagementSystem.Business.Exceptions.ConflictException: Book With Id 1 Already loaned
   at LibraryManagementSystem.Business.Services.BookService.BorrowBookAsync(Int32 bookId, String userId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 250
   at LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync(Int32 bookId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 334
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 17:18:55.117 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/1/Borrow - 409 null application/problem+json 12333.8093ms
2025-09-28 17:45:26.832 +03:00 [INF] Starting database seeding.
2025-09-28 17:45:27.063 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 17:45:28.356 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:45:28.419 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:45:28.422 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:45:28.435 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 17:45:28.467 +03:00 [INF] Database seeding finished successfully.
2025-09-28 17:45:28.742 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 17:45:28.744 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 17:45:28.830 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 17:45:28.833 +03:00 [INF] Hosting environment: Development
2025-09-28 17:45:28.834 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 17:45:42.726 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/3/Borrow - null 0
2025-09-28 17:45:42.778 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/3/Borrow - 307 0 null 56.3593ms
2025-09-28 17:45:42.811 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/3/Borrow - null 0
2025-09-28 17:45:42.924 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:45:42.926 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:45:42.927 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:45:42.930 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:45:42.935 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 17:45:42.936 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:45:42.940 +03:00 [INF] Incomming Request: PUT /api/Books/3/Borrow
2025-09-28 17:45:42.942 +03:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2025-09-28 17:45:42.943 +03:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2025-09-28 17:45:42.944 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 17:45:42.947 +03:00 [INF] Generating expiration headers.
2025-09-28 17:45:42.949 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 14:46:42 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 17:45:42.953 +03:00 [INF] Not generating Validation headers as the response status code does not indicate success.
2025-09-28 17:45:42.954 +03:00 [INF] Generating Vary header.
2025-09-28 17:45:42.955 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 17:45:43.006 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/3/Borrow - 405 null application/problem+json 194.3916ms
2025-09-28 17:45:49.780 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/3/Borrow - null 0
2025-09-28 17:45:49.833 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/3/Borrow - 307 0 null 53.0264ms
2025-09-28 17:45:49.836 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/3/Borrow - null 0
2025-09-28 17:45:49.869 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:45:49.870 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:45:49.872 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:45:49.873 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:45:49.874 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 17:45:49.875 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:45:49.876 +03:00 [INF] Incomming Request: POST /api/Books/3/Borrow
2025-09-28 17:45:49.879 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:45:49.902 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 17:45:50.064 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:45:50.275 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 17:45:50.339 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 17:45:50.402 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 17:45:50.554 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Date), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Borrowings] ([BookId], [BorrowDate], [BorrowerId], [DeleteDate], [ReturnDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-28 17:45:50.615 +03:00 [INF] Executing ObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.BorrowingDtos.BorrowingDetailsDto'.
2025-09-28 17:45:50.631 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 723.4706ms
2025-09-28 17:45:50.633 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:45:50.635 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 17:45:50.637 +03:00 [INF] Generating expiration headers.
2025-09-28 17:45:50.638 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 14:46:50 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 17:45:50.640 +03:00 [INF] Generating Validation headers.
2025-09-28 17:45:50.650 +03:00 [INF] Validation headers generated. ETag: Strong, "53E62C1833D0CB9866944709E2587B72". Last-Modified: Sun, 28 Sep 2025 14:45:50 GMT
2025-09-28 17:45:50.651 +03:00 [INF] Generating Vary header.
2025-09-28 17:45:50.653 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 17:45:50.661 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/3/Borrow - 201 null application/json; charset=utf-8 824.835ms
2025-09-28 17:49:13.850 +03:00 [INF] Starting database seeding.
2025-09-28 17:49:14.056 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 17:49:15.241 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:49:15.303 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:49:15.307 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:49:15.319 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 17:49:15.355 +03:00 [INF] Database seeding finished successfully.
2025-09-28 17:49:15.642 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 17:49:15.644 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 17:49:15.729 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 17:49:15.731 +03:00 [INF] Hosting environment: Development
2025-09-28 17:49:15.732 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 17:49:31.446 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/4/Borrow - null 0
2025-09-28 17:49:31.545 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/4/Borrow - 307 0 null 104.6751ms
2025-09-28 17:49:31.586 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/4/Borrow - null 0
2025-09-28 17:49:31.702 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:49:31.704 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:49:31.705 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:49:31.708 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:49:31.709 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 17:49:31.711 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:49:31.718 +03:00 [INF] Incomming Request: POST /api/Books/4/Borrow
2025-09-28 17:49:31.722 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:49:31.752 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 17:49:31.876 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:49:32.006 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 17:49:32.059 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 17:49:32.127 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 17:49:32.265 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Date), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Borrowings] ([BookId], [BorrowDate], [BorrowerId], [DeleteDate], [ReturnDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-28 17:49:32.298 +03:00 [INF] Executing ObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.BorrowingDtos.BorrowingDetailsDto'.
2025-09-28 17:49:32.315 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 556.9776ms
2025-09-28 17:49:32.319 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:49:32.322 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 17:49:32.328 +03:00 [INF] Generating expiration headers.
2025-09-28 17:49:32.330 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 14:50:32 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 17:49:32.332 +03:00 [INF] Generating Validation headers.
2025-09-28 17:49:32.344 +03:00 [INF] Validation headers generated. ETag: Strong, "5074A8A4F8828004951DBD181C9D3A3E". Last-Modified: Sun, 28 Sep 2025 14:49:32 GMT
2025-09-28 17:49:32.347 +03:00 [INF] Generating Vary header.
2025-09-28 17:49:32.348 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 17:49:32.355 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/4/Borrow - 201 null application/json; charset=utf-8 769.0966ms
2025-09-28 17:50:13.402 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/5/Borrow - null 0
2025-09-28 17:50:13.407 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/5/Borrow - 307 0 null 6.3489ms
2025-09-28 17:50:13.414 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/5/Borrow - null 0
2025-09-28 17:50:13.420 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:50:13.421 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:50:13.423 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:50:13.424 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:50:13.426 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 17:50:13.428 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:50:13.429 +03:00 [INF] Incomming Request: POST /api/Books/5/Borrow
2025-09-28 17:50:13.433 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:50:13.437 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 17:50:13.443 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:50:13.456 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 17:50:13.469 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 17:50:13.477 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 17:50:13.489 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Date), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Borrowings] ([BookId], [BorrowDate], [BorrowerId], [DeleteDate], [ReturnDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-28 17:52:16.360 +03:00 [INF] Executing ObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.BorrowingDtos.BorrowingDetailsDto'.
2025-09-28 17:52:16.367 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 122927.1342ms
2025-09-28 17:52:16.371 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:52:16.375 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 17:52:16.379 +03:00 [INF] Generating expiration headers.
2025-09-28 17:52:16.381 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 14:53:16 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 17:52:16.382 +03:00 [INF] Generating Validation headers.
2025-09-28 17:52:16.388 +03:00 [INF] Validation headers generated. ETag: Strong, "FB92B4564FBC8A0A10D85ED820E2D182". Last-Modified: Sun, 28 Sep 2025 14:52:16 GMT
2025-09-28 17:52:16.391 +03:00 [INF] Generating Vary header.
2025-09-28 17:52:16.395 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 17:52:16.396 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/5/Borrow - 201 null application/json; charset=utf-8 122982.0554ms
2025-09-28 17:52:31.769 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/6/Borrow - null 0
2025-09-28 17:52:31.773 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/6/Borrow - 307 0 null 4.5866ms
2025-09-28 17:52:31.778 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/6/Borrow - null 0
2025-09-28 17:52:31.789 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:52:31.792 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:52:31.793 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:52:31.797 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:52:31.799 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 17:52:31.800 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:52:31.801 +03:00 [INF] Incomming Request: POST /api/Books/6/Borrow
2025-09-28 17:52:31.803 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:52:31.808 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 17:52:31.821 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:52:31.825 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 17:53:13.692 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 41877.1042ms
2025-09-28 17:53:13.695 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:53:15.127 +03:00 [ERR] An unhandled exception has occurred while executing the request.
LibraryManagementSystem.Business.Exceptions.NotFoundException: Book with id 6 not found.
   at LibraryManagementSystem.Business.Services.BookService.ThrowNotFoundExceptionIfBookNotExist(Int32 id, Book book) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 325
   at LibraryManagementSystem.Business.Services.BookService.BorrowBookAsync(Int32 bookId, String userId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 248
   at LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync(Int32 bookId)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 17:53:15.184 +03:00 [WRN] A Not Found exception has occured: Book with id 6 not found.
LibraryManagementSystem.Business.Exceptions.NotFoundException: Book with id 6 not found.
   at LibraryManagementSystem.Business.Services.BookService.ThrowNotFoundExceptionIfBookNotExist(Int32 id, Book book) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 325
   at LibraryManagementSystem.Business.Services.BookService.BorrowBookAsync(Int32 bookId, String userId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 248
   at LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync(Int32 bookId)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 17:53:15.239 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/6/Borrow - 404 null application/problem+json 43460.9092ms
2025-09-28 17:53:25.708 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/27/Borrow - null 0
2025-09-28 17:53:25.712 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/27/Borrow - 307 0 null 3.8657ms
2025-09-28 17:53:25.718 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/27/Borrow - null 0
2025-09-28 17:53:25.728 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:53:25.730 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:53:25.735 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:53:25.737 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:53:25.739 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 17:53:25.741 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:53:25.744 +03:00 [INF] Incomming Request: POST /api/Books/27/Borrow
2025-09-28 17:53:25.749 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:53:25.754 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 17:53:25.761 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:53:25.769 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 17:53:25.785 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 17:53:25.807 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 17:53:25.831 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Date), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Borrowings] ([BookId], [BorrowDate], [BorrowerId], [DeleteDate], [ReturnDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-28 17:53:46.085 +03:00 [INF] Executing ObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.BorrowingDtos.BorrowingDetailsDto'.
2025-09-28 17:53:46.094 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 20334.0444ms
2025-09-28 17:53:46.097 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:53:46.098 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 17:53:46.100 +03:00 [INF] Generating expiration headers.
2025-09-28 17:53:46.101 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 14:54:46 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 17:53:46.102 +03:00 [INF] Generating Validation headers.
2025-09-28 17:53:46.104 +03:00 [INF] Validation headers generated. ETag: Strong, "6D5F9130C2CA1FD18DCB243015136986". Last-Modified: Sun, 28 Sep 2025 14:53:46 GMT
2025-09-28 17:53:46.106 +03:00 [INF] Generating Vary header.
2025-09-28 17:53:46.110 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 17:53:46.112 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/27/Borrow - 201 null application/json; charset=utf-8 20394.5039ms
2025-09-28 17:54:38.959 +03:00 [INF] Starting database seeding.
2025-09-28 17:54:39.167 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 17:54:40.353 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:54:40.411 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:54:40.416 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 17:54:40.430 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 17:54:40.465 +03:00 [INF] Database seeding finished successfully.
2025-09-28 17:54:40.751 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 17:54:40.753 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 17:54:40.838 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 17:54:40.841 +03:00 [INF] Hosting environment: Development
2025-09-28 17:54:40.842 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 17:55:33.324 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/28/Borrow - null 0
2025-09-28 17:55:33.390 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/28/Borrow - 307 0 null 71.564ms
2025-09-28 17:55:33.425 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/28/Borrow - null 0
2025-09-28 17:55:33.542 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 17:55:33.544 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 17:55:33.545 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 17:55:33.548 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 17:55:33.549 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 17:55:33.551 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 17:55:33.555 +03:00 [INF] Incomming Request: POST /api/Books/28/Borrow
2025-09-28 17:55:33.558 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:55:33.577 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 17:55:33.696 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 17:55:33.828 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 17:55:33.883 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 17:55:33.954 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 17:55:34.095 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Date), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Borrowings] ([BookId], [BorrowDate], [BorrowerId], [DeleteDate], [ReturnDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-28 17:55:34.128 +03:00 [INF] Executing ObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.BorrowingDtos.BorrowingDetailsDto'.
2025-09-28 17:55:34.145 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 562.1869ms
2025-09-28 17:55:34.149 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 17:55:34.151 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 17:55:34.157 +03:00 [INF] Generating expiration headers.
2025-09-28 17:55:34.159 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 14:56:34 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 17:55:34.162 +03:00 [INF] Generating Validation headers.
2025-09-28 17:55:34.176 +03:00 [INF] Validation headers generated. ETag: Strong, "604618A0955E39240B9AAA231A19662A". Last-Modified: Sun, 28 Sep 2025 14:55:34 GMT
2025-09-28 17:55:34.180 +03:00 [INF] Generating Vary header.
2025-09-28 17:55:34.183 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 17:55:34.191 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/28/Borrow - 201 null application/json; charset=utf-8 765.4674ms
2025-09-28 18:04:45.084 +03:00 [INF] Starting database seeding.
2025-09-28 18:04:45.298 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 18:04:46.501 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:04:46.561 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:04:46.565 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:04:46.576 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 18:04:46.614 +03:00 [INF] Database seeding finished successfully.
2025-09-28 18:04:46.887 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 18:04:46.889 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 18:04:46.978 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 18:04:46.980 +03:00 [INF] Hosting environment: Development
2025-09-28 18:04:46.981 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 18:04:51.857 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/28/Borrow - null 0
2025-09-28 18:04:51.983 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/28/Borrow - 307 0 null 131.9031ms
2025-09-28 18:04:52.025 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/28/Borrow - null 0
2025-09-28 18:04:52.154 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 18:04:52.156 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 18:04:52.159 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 18:04:52.166 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 18:04:52.168 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 18:04:52.170 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 18:04:52.175 +03:00 [INF] Incomming Request: POST /api/Books/28/Borrow
2025-09-28 18:04:52.181 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 18:04:52.207 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 18:04:52.368 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 18:04:52.549 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 18:04:52.624 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 18:04:52.721 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 18:04:52.906 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Date), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Borrowings] ([BookId], [BorrowDate], [BorrowerId], [DeleteDate], [ReturnDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-28 18:04:52.947 +03:00 [INF] Executing ObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.BorrowingDtos.BorrowingDetailsDto'.
2025-09-28 18:04:52.967 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 752.0079ms
2025-09-28 18:04:52.970 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 18:04:52.971 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 18:04:52.979 +03:00 [INF] Generating expiration headers.
2025-09-28 18:04:52.981 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 15:05:52 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 18:04:52.984 +03:00 [INF] Generating Validation headers.
2025-09-28 18:04:52.999 +03:00 [INF] Validation headers generated. ETag: Strong, "F45190DF4892ADA7A780D40B2532B3E2". Last-Modified: Sun, 28 Sep 2025 15:04:52 GMT
2025-09-28 18:04:53.002 +03:00 [INF] Generating Vary header.
2025-09-28 18:04:53.004 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 18:04:53.019 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/28/Borrow - 201 null application/json; charset=utf-8 993.0797ms
2025-09-28 18:05:06.385 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/27/Borrow - null 0
2025-09-28 18:05:06.391 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/27/Borrow - 307 0 null 5.7589ms
2025-09-28 18:05:06.394 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/27/Borrow - null 0
2025-09-28 18:05:06.400 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 18:05:06.401 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 18:05:06.402 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 18:05:06.406 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 18:05:06.409 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 18:05:06.410 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 18:05:06.411 +03:00 [INF] Incomming Request: POST /api/Books/27/Borrow
2025-09-28 18:05:06.413 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 18:05:06.415 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 18:05:06.423 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 18:05:06.435 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 18:05:06.445 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 18:05:06.456 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 18:05:06.466 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Date), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Borrowings] ([BookId], [BorrowDate], [BorrowerId], [DeleteDate], [ReturnDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-28 18:05:06.475 +03:00 [INF] Executing ObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.BorrowingDtos.BorrowingDetailsDto'.
2025-09-28 18:05:06.481 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 61.194ms
2025-09-28 18:05:06.484 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 18:05:06.488 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 18:05:06.489 +03:00 [INF] Generating expiration headers.
2025-09-28 18:05:06.491 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 15:06:06 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 18:05:06.493 +03:00 [INF] Generating Validation headers.
2025-09-28 18:05:06.495 +03:00 [INF] Validation headers generated. ETag: Strong, "72BF3612B8E27A5D763EB3072A33814C". Last-Modified: Sun, 28 Sep 2025 15:05:06 GMT
2025-09-28 18:05:06.499 +03:00 [INF] Generating Vary header.
2025-09-28 18:05:06.500 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 18:05:06.503 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/27/Borrow - 201 null application/json; charset=utf-8 109.1985ms
2025-09-28 18:06:44.450 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/27/Borrow - null 0
2025-09-28 18:06:44.458 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/27/Borrow - 307 0 null 8.165ms
2025-09-28 18:06:44.459 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/27/Borrow - null 0
2025-09-28 18:06:44.466 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 18:06:44.467 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 18:06:44.469 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 18:06:44.470 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 18:06:44.472 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 18:06:44.475 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 18:06:44.476 +03:00 [INF] Incomming Request: POST /api/Books/27/Borrow
2025-09-28 18:06:44.479 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 18:06:44.481 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 18:06:44.492 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 18:06:44.499 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 18:06:44.513 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 18:06:44.521 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 18:11:02.627 +03:00 [INF] Starting database seeding.
2025-09-28 18:11:02.914 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 18:11:04.318 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:11:04.376 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:11:04.379 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:11:04.392 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 18:11:04.425 +03:00 [INF] Database seeding finished successfully.
2025-09-28 18:11:04.736 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 18:11:04.738 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 18:11:04.831 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 18:11:04.833 +03:00 [INF] Hosting environment: Development
2025-09-28 18:11:04.835 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 18:11:27.279 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/27/Borrow - null 0
2025-09-28 18:11:27.338 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/27/Borrow - 307 0 null 63.715ms
2025-09-28 18:11:27.374 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/27/Borrow - null 0
2025-09-28 18:11:27.494 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 18:11:27.496 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 18:11:27.497 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 18:11:27.500 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 18:11:27.501 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 18:11:27.502 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 18:11:27.508 +03:00 [INF] Incomming Request: POST /api/Books/27/Borrow
2025-09-28 18:11:27.513 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 18:11:27.537 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 18:11:27.659 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 18:11:27.796 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 18:11:27.863 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccessFailedCount], [s].[ConcurrencyStamp], [s].[Email], [s].[EmailConfirmed], [s].[LockoutEnabled], [s].[LockoutEnd], [s].[NormalizedEmail], [s].[NormalizedUserName], [s].[PasswordHash], [s].[PersonId], [s].[PhoneNumber], [s].[PhoneNumberConfirmed], [s].[RefreshToken], [s].[RefreshTokenExpiryTime], [s].[SecurityStamp], [s].[TwoFactorEnabled], [s].[UserName], [s].[Id0], [s].[FirstName], [s].[LastName], [s].[Id1], [s].[PersonId0], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id] AS [Id0], [p].[FirstName], [p].[LastName], [b].[Id] AS [Id1], [b].[PersonId] AS [PersonId0]
    FROM [AspNetUsers] AS [a]
    INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
    LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
    WHERE [a].[Id] = @__userId_0
) AS [s]
LEFT JOIN [Borrowings] AS [b0] ON [s].[Id1] = [b0].[BorrowerId]
ORDER BY [s].[Id], [s].[Id0], [s].[Id1]
2025-09-28 18:11:27.943 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 18:11:28.066 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Date), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Borrowings] ([BookId], [BorrowDate], [BorrowerId], [DeleteDate], [ReturnDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-28 18:11:28.100 +03:00 [INF] Executing ObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.BorrowingDtos.BorrowingDetailsDto'.
2025-09-28 18:11:28.116 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 569.4792ms
2025-09-28 18:11:28.119 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 18:11:28.124 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 18:11:28.128 +03:00 [INF] Generating expiration headers.
2025-09-28 18:11:28.129 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 15:12:28 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 18:11:28.134 +03:00 [INF] Generating Validation headers.
2025-09-28 18:11:28.146 +03:00 [INF] Validation headers generated. ETag: Strong, "1EAB0E51FDC42A8FBA555BA1DF53E50F". Last-Modified: Sun, 28 Sep 2025 15:11:28 GMT
2025-09-28 18:11:28.150 +03:00 [INF] Generating Vary header.
2025-09-28 18:11:28.153 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 18:11:28.161 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/27/Borrow - 201 null application/json; charset=utf-8 787.0156ms
2025-09-28 18:11:36.088 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Books/28/Borrow - null 0
2025-09-28 18:11:36.094 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Books/28/Borrow - 307 0 null 6.1197ms
2025-09-28 18:11:36.096 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Books/28/Borrow - null 0
2025-09-28 18:11:36.101 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 18:11:36.102 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 18:11:36.104 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 18:11:36.107 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 18:11:36.109 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 18:11:36.111 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 18:11:36.112 +03:00 [INF] Incomming Request: POST /api/Books/28/Borrow
2025-09-28 18:11:36.114 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 18:11:36.117 +03:00 [INF] Route matched with {action = "BorrowBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BorrowBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 18:11:36.126 +03:00 [INF] Executing an action BorrowBook on controller Books.
2025-09-28 18:11:36.140 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b1].[Id], [b1].[DeleteDate], [b1].[ISBN], [b1].[PublishYear], [b1].[Title], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(2) [b].[Id], [b].[DeleteDate], [b].[ISBN], [b].[PublishYear], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__id_0
) AS [b1]
LEFT JOIN [Borrowings] AS [b0] ON [b1].[Id] = [b0].[BookId]
ORDER BY [b1].[Id]
2025-09-28 18:11:36.148 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccessFailedCount], [s].[ConcurrencyStamp], [s].[Email], [s].[EmailConfirmed], [s].[LockoutEnabled], [s].[LockoutEnd], [s].[NormalizedEmail], [s].[NormalizedUserName], [s].[PasswordHash], [s].[PersonId], [s].[PhoneNumber], [s].[PhoneNumberConfirmed], [s].[RefreshToken], [s].[RefreshTokenExpiryTime], [s].[SecurityStamp], [s].[TwoFactorEnabled], [s].[UserName], [s].[Id0], [s].[FirstName], [s].[LastName], [s].[Id1], [s].[PersonId0], [b0].[Id], [b0].[BookId], [b0].[BorrowDate], [b0].[BorrowerId], [b0].[DeleteDate], [b0].[ReturnDate]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id] AS [Id0], [p].[FirstName], [p].[LastName], [b].[Id] AS [Id1], [b].[PersonId] AS [PersonId0]
    FROM [AspNetUsers] AS [a]
    INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
    LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
    WHERE [a].[Id] = @__userId_0
) AS [s]
LEFT JOIN [Borrowings] AS [b0] ON [s].[Id1] = [b0].[BorrowerId]
ORDER BY [s].[Id], [s].[Id0], [s].[Id1]
2025-09-28 18:11:36.164 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__borrowerId_0='?' (DbType = Int32), @__p_1='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Borrowings] AS [b]
        WHERE [b].[BorrowerId] = @__borrowerId_0 AND [b].[ReturnDate] IS NULL AND DATEADD(day, CAST(@__p_1 AS int), GETDATE()) < GETDATE()) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 18:11:44.958 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API) in 8835.5342ms
2025-09-28 18:11:44.962 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync (LibraryManagementSystem.API)'
2025-09-28 18:11:46.739 +03:00 [ERR] An unhandled exception has occurred while executing the request.
LibraryManagementSystem.Business.Exceptions.BadRequestException: Borrower can't borrow more because he reach the limit of loans 5
   at LibraryManagementSystem.Business.Services.BookService.BorrowBookAsync(Int32 bookId, String userId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 277
   at LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync(Int32 bookId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 333
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 18:11:46.821 +03:00 [WRN] An Bad Request exception has occured: Borrower can't borrow more because he reach the limit of loans 5
LibraryManagementSystem.Business.Exceptions.BadRequestException: Borrower can't borrow more because he reach the limit of loans 5
   at LibraryManagementSystem.Business.Services.BookService.BorrowBookAsync(Int32 bookId, String userId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.Business\Services\BookService.cs:line 277
   at LibraryManagementSystem.API.Controllers.BooksController.BorrowBookAsync(Int32 bookId) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Controllers\BooksController.cs:line 333
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at LibraryBookManagementSystem.API.Middlewares.RequestLoggingHandler.Invoke(HttpContext context) in F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API\Middlewares\RequestLoggingHandler.cs:line 24
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.HandleResponse(HttpContext httpContext)
   at Marvin.Cache.Headers.HttpCacheHeadersMiddleware.Invoke(HttpContext httpContext, IValidatorValueInvalidator validatorValueInvalidator)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-28 18:11:46.890 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Books/28/Borrow - 400 null application/problem+json 10793.8711ms
2025-09-28 18:12:37.914 +03:00 [INF] Starting database seeding.
2025-09-28 18:12:38.147 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 18:12:39.303 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:12:39.381 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:12:39.390 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:12:39.411 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 18:12:39.462 +03:00 [INF] Database seeding finished successfully.
2025-09-28 18:12:39.755 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 18:12:39.756 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 18:12:39.845 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 18:12:39.847 +03:00 [INF] Hosting environment: Development
2025-09-28 18:12:39.849 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 18:46:39.676 +03:00 [INF] Starting database seeding.
2025-09-28 18:46:40.232 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-28 18:46:42.369 +03:00 [INF] Executed DbCommand (96ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:46:42.441 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:46:42.446 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-09-28 18:46:42.464 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 18:46:42.518 +03:00 [INF] Database seeding finished successfully.
2025-09-28 18:46:43.250 +03:00 [INF] Now listening on: https://localhost:7266
2025-09-28 18:46:43.255 +03:00 [INF] Now listening on: http://localhost:5132
2025-09-28 18:46:43.395 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-28 18:46:43.397 +03:00 [INF] Hosting environment: Development
2025-09-28 18:46:43.399 +03:00 [INF] Content root path: F:\RestfulApiCourse\LibrarySystem\LibraryManagementSystem.API
2025-09-28 18:46:43.774 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/27/Return - null 0
2025-09-28 18:46:43.866 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/27/Return - 307 0 null 91.9549ms
2025-09-28 18:46:43.910 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/27/Return - null 0
2025-09-28 18:46:45.295 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/28/2025 3:09:32 PM', Current time (UTC): '9/28/2025 3:46:45 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-28 18:46:45.315 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/28/2025 3:09:32 PM', Current time (UTC): '9/28/2025 3:46:45 PM'.
2025-09-28 18:46:45.326 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Borrower)
2025-09-28 18:46:45.336 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-28 18:46:45.340 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/27/Return - 401 0 null 1430.6559ms
2025-09-28 19:22:22.887 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - application/json 521
2025-09-28 19:22:22.895 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5132/api/Token/Refresh - 307 0 null 9.5802ms
2025-09-28 19:22:22.898 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7266/api/Token/Refresh - application/json 521
2025-09-28 19:22:22.915 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 19:22:22.917 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 19:22:22.918 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 19:22:22.923 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 19:22:22.924 +03:00 [INF] Not valid - method isn't PUT or PATCH.
2025-09-28 19:22:22.926 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 19:22:22.932 +03:00 [INF] Incomming Request: POST /api/Token/Refresh
2025-09-28 19:22:22.934 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API)'
2025-09-28 19:22:22.957 +03:00 [INF] Route matched with {action = "Refresh", controller = "Token"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Refresh(LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto) on controller LibraryManagementSystem.API.Controllers.TokenController (LibraryManagementSystem.API).
2025-09-28 19:22:23.116 +03:00 [INF] Executing an action Refresh on controller Token.
2025-09-28 19:22:23.218 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-09-28 19:22:23.259 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-09-28 19:22:23.287 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-09-28 19:22:23.301 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-09-28 19:22:23.406 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p17='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p18='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 256), @p7='?' (Size = 256), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [LockoutEnabled] = @p4, [LockoutEnd] = @p5, [NormalizedEmail] = @p6, [NormalizedUserName] = @p7, [PasswordHash] = @p8, [PersonId] = @p9, [PhoneNumber] = @p10, [PhoneNumberConfirmed] = @p11, [RefreshToken] = @p12, [RefreshTokenExpiryTime] = @p13, [SecurityStamp] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-09-28 19:22:23.434 +03:00 [INF] Executing OkObjectResult, writing value of type 'LibraryManagementSystem.Business.Dtos.AccountDtos.TokenDto'.
2025-09-28 19:22:23.443 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API) in 477.4788ms
2025-09-28 19:22:23.447 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.TokenController.Refresh (LibraryManagementSystem.API)'
2025-09-28 19:22:23.450 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 19:22:23.454 +03:00 [INF] Generating expiration headers.
2025-09-28 19:22:23.456 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 16:23:23 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 19:22:23.461 +03:00 [INF] Generating Validation headers.
2025-09-28 19:22:23.472 +03:00 [INF] Validation headers generated. ETag: Strong, "8BCE2484AB6E9C7523423416980F5215". Last-Modified: Sun, 28 Sep 2025 16:22:23 GMT
2025-09-28 19:22:23.476 +03:00 [INF] Generating Vary header.
2025-09-28 19:22:23.479 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 19:22:23.488 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7266/api/Token/Refresh - 200 null application/json; charset=utf-8 590.1428ms
2025-09-28 19:22:57.039 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5132/api/Books/27/Return - null 0
2025-09-28 19:22:57.047 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5132/api/Books/27/Return - 307 0 null 7.3766ms
2025-09-28 19:22:57.049 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7266/api/Books/27/Return - null 0
2025-09-28 19:22:57.065 +03:00 [INF] Checking for conditional GET/HEAD.
2025-09-28 19:22:57.067 +03:00 [INF] Not valid - method isn't GET or HEAD.
2025-09-28 19:22:57.068 +03:00 [INF] Don't generate 304 - Not Modified.  Continue.
2025-09-28 19:22:57.071 +03:00 [INF] Checking for conditional PUT/PATCH.
2025-09-28 19:22:57.073 +03:00 [INF] Not valid - no If Match or If Unmodified-Since headers.
2025-09-28 19:22:57.074 +03:00 [INF] Don't generate 412 - Precondition Failed.  Continue.
2025-09-28 19:22:57.076 +03:00 [INF] Incomming Request: PUT /api/Books/27/Return
2025-09-28 19:22:57.080 +03:00 [INF] Executing endpoint 'LibraryManagementSystem.API.Controllers.BooksController.ReturnBookAsync (LibraryManagementSystem.API)'
2025-09-28 19:22:57.088 +03:00 [INF] Route matched with {action = "ReturnBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnBookAsync(Int32) on controller LibraryManagementSystem.API.Controllers.BooksController (LibraryManagementSystem.API).
2025-09-28 19:22:57.101 +03:00 [INF] Executing an action ReturnBook on controller Books.
2025-09-28 19:22:57.135 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Books] AS [b]
        WHERE [b].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-28 19:22:57.180 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonId], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RefreshToken], [a].[RefreshTokenExpiryTime], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [p].[Id], [p].[FirstName], [p].[LastName], [b].[Id], [b].[PersonId]
FROM [AspNetUsers] AS [a]
INNER JOIN [Persons] AS [p] ON [a].[PersonId] = [p].[Id]
LEFT JOIN [Borrowers] AS [b] ON [p].[Id] = [b].[PersonId]
WHERE [a].[Id] = @__userId_0
2025-09-28 19:22:57.225 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__bookId_0='?' (DbType = Int32), @__borrowerId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [b].[Id], [b].[BookId], [b].[BorrowDate], [b].[BorrowerId], [b].[DeleteDate], [b].[ReturnDate]
FROM [Borrowings] AS [b]
WHERE [b].[BookId] = @__bookId_0 AND [b].[BorrowerId] = @__borrowerId_1 AND [b].[ReturnDate] IS NULL
2025-09-28 19:22:57.266 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Date)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Borrowings] SET [ReturnDate] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-09-28 19:22:57.272 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-09-28 19:22:57.275 +03:00 [INF] Executed action LibraryManagementSystem.API.Controllers.BooksController.ReturnBookAsync (LibraryManagementSystem.API) in 177.8019ms
2025-09-28 19:22:57.277 +03:00 [INF] Executed endpoint 'LibraryManagementSystem.API.Controllers.BooksController.ReturnBookAsync (LibraryManagementSystem.API)'
2025-09-28 19:22:57.281 +03:00 [INF] Outgoing Response: {Status Code}
2025-09-28 19:22:57.285 +03:00 [INF] Generating expiration headers.
2025-09-28 19:22:57.286 +03:00 [INF] Expiration headers generated. Expires: Sun, 28 Sep 2025 16:23:57 GMT. Cache-Control: public,max-age=60,must-revalidate.
2025-09-28 19:22:57.289 +03:00 [INF] Generating Validation headers.
2025-09-28 19:22:57.292 +03:00 [INF] Validation headers generated. ETag: Strong, "80E82A2BF2DF6185FF8B06BE9C5CC745". Last-Modified: Sun, 28 Sep 2025 16:22:57 GMT
2025-09-28 19:22:57.297 +03:00 [INF] Generating Vary header.
2025-09-28 19:22:57.300 +03:00 [INF] Vary header generated: Accept, Accept-Language, Accept-Encoding.
2025-09-28 19:22:57.302 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7266/api/Books/27/Return - 200 null text/plain; charset=utf-8 254.0378ms
